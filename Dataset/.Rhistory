2+2
39+285+67.28+30+107
(7+6+16+5+4)/2
(5.99+3.49+6.99+15.59+4.99)/2
(275 *6)/2
(300*6)/2
62137.50-27984.75
14000+12000+3000
34152.75 - 29000
2620+2620
2620*2
(80/100)/(1- 80/100)
20+120+360
a.	install.packages(“R2jags”)
install.packages(“R2jags”)
install.packages("R2jags")
install.packages("coda")
install.packages("rjags")
39.33+26.22+26.22
140000+3000+12000
14000+3000+12000
34153-29000
2373.00+2620.00
285+137.36+80+39+47.40-110.87
7551.00+14000.00+9438.50+3000.00+12000.00+9713.00+150.00+564.00+5721.00
7551.00+564.00+700.50+5721.00+564.00+728.25+5721.00
7551.00+564.00+700.50+5721.00+564.00+728.25+5721.00+150.00+564.00+5721.00
62137.50-27984.75
34152.75 - 29000
728.25+5152.75
62137.50 - $27984.75
62137.50 - 27984.75
34152.75 - 29,000
34152.75 - 29000
2373.00+2620
5152.75 - 4993
2373+80+2620+80
20+120+360
180+150+70
20/1000 * 1000
120/3000*10000
120/3000*1000
360/6000*1000
180/6000*1000
150/3000*1000
70/1000*1000
60+120+24-
60+120+240
90+150+280
19.18+39+15.99+13.40+38.25+51.34+16.92+83.12+12.01+100.85
(200/300)-(140/260)
(200/300)-(140/260)
(250/340)-(200/380)
(450/640)-(340/640)
200+60+140+120
250+90+200+180
Xunder35 <- (200*(140+120) - 140*(200+60))/520
Xover35 <- (250*(200+180) - 200*(250+90))/720
X < - Xunder35 + Xover35
X <- Xunder35 + Xover35
Yunder35 <- ((200+60)*(140+120))/520
Yover35 <- ((250+90)*(200+180))/720
Y <- Yunder35 + Yover35
X/Y
(43/50+49/50+48.5/50)
(43/50+49/50+48.5/50)/3
(50*80)/(20*50)
.96*50
.7*20
(48*86)/(52*14)
1.55+.66+2.29+0.79+6.99+0+4.29+0+6.98+3.99+2.69+5.98
1.55+.66+2.29+0.79+6.99+6.99+4.29+3.99+6.98+3.99+2.69+5.98
1.55+.66+2.29+0.79+6.99+6.99+2.29+3.99+6.98+3.99+2.69+5.98
+5
45.19+5
setwd("~/Documents/GitHub/lizzyandshelley")
knitr::opts_chunk$set(echo = TRUE)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley") #LIZZY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
setwd("~/Documents/GitHub/lizzyandshelley/Dataset")
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#open packages
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(lme4)
library(MASS)
library(mice)
install.packages("mice")
#open packages
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(lme4)
library(MASS)
library(mice)
library(biostat3)
install.packages("biostat3")
install.packages("lmtest")
install.packages("gee")
#open packages
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(lme4)
library(MASS)
library(mice)
library(biostat3)
library(lmtest)
library(gee)
```{r}
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#setwd("~/GitHub/lizzyandshelley/Dataset")  #SHELLEY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
View(df)
install.packages(c("biostat3", "gee", "lmtest", "mice"))
install.packages(c("biostat3", "gee", "lmtest", "mice"))
names(df)
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
df.labels$description[df.labels$VAR_ID=="GENDER"]
Create substance use indicators.
```{r}
table(df$CRKINJ, useNA = "ifany")
```
Create substance use indicators.
```{r}
table(df$CRKINJ, useNA = "ifany")
```
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(lme4)
library(MASS)
library(mice)
library(biostat3)
library(lmtest)
library(gee)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#setwd("~/GitHub/lizzyandshelley/Dataset")  #SHELLEY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
df.labels$description[df.labels$VAR_ID=="GENDER"]
table(df$CRKINJ, useNA = "ifany")
# #powder cocaine injection
table(df$CCINJ, useNA = "ifany")
#meth injection
table(df$MTINJ, useNA = "ifany")
#prescription stimulant injection
table(df$STINJ, useNA = "ifany")
#heroin injection
table(df$HRINJ, useNA = "ifany")
#NMPO injection
table(df$OPINJ, useNA = "ifany")
df.labels$description[df.labels$VAR_ID=="ALCDAY"]
df.labels$description[df.labels$VAR_ID=="ALCTX"]
#any stimulant injection (composite)
df$ANYSTIM <- ifelse(df$CRKINJ=="Yes" | df$CCINJ=="Yes" | df$MTINJ=="Yes" | df$STINJ=="Yes", 1, ifelse(df$CRKINJ=="No" & df$CCINJ=="No" & df$MTINJ=="No" & df$STINJ=="No", 0, NA))
table(df$ALCDAY, useNA = "ifany")
table(df$ALCTX, useNA = "ifany")
table(df$binge, useNA = "ifany")
df$binge <- ifelse(df$ALCDAY==0, 0, ifelse(df$ALCTX<4, 0, ifelse(df$ALCTX>3, 1, NA))) #binge alcohol on a typical day (>3 drinks)
table(df$binge, useNA = "ifany")
table(df$ANYSTIM, useNA = "ifany")
table(df$ANYOPIATE, useNA = "ifany")
#any opioid injection (composite)
df$ANYOPIATE <- ifelse(df$HRINJ=="Yes" | df$OPINJ=="Yes", 1, ifelse(df$HRINJ=="No" & df$OPINJ=="No", 0, NA))
table(df$ANYOPIATE, useNA = "ifany")
df$AGE <- as.numeric(df$AGE)
table(df$AGE, useNA = "ifany")
#homelessness
df$MOSHOME <- as.numeric(df$MOSHOME)
df$HOMELESS <- as.numeric(df$HOMELESS)
table(df$MOSHOME, useNA = "ifany")
#homelessness
df$HOMELESS <- as.numeric(df$HOMELESS)
table(df$HOMELESS, useNA = "ifany")
table(df$MOSHOME, useNA = "ifany")
df.labels$description[df.labels$VAR_ID=="HOMELESS"]
df.labels$description[df.labels$VAR_ID=="MOSHOME"]
table(df$HOMELESS, useNA = "ifany")
table(df$MOSHOME, useNA = "ifany")
#public injection
table(df$PUBINJ, useNA = "ifany")
df.labels$description[df.labels$VAR_ID=="PUBINJ"]
dfs$PUBINJ_3cat <- as.factor(ifelse(dfs$PUBINJ=="Never (0% of the time)", 0, ifelse(dfs$PUBINJ=="Occasionally (less than 25% of the time)" | dfs$PUBINJ=="Sometimes (25% to 74% of the time)", 1, ifelse(dfs$PUBINJ=="Usually (75% to 99% of the time)" | dfs$PUBINJ=="Always (100% of the time)", 2, NA))))
df$PUBINJ_3cat <- as.factor(ifelse(df$PUBINJ=="Never (0% of the time)", 0, ifelse(df$PUBINJ=="Occasionally (less than 25% of the time)" | df$PUBINJ=="Sometimes (25% to 74% of the time)", 1, ifelse(df$PUBINJ=="Usually (75% to 99% of the time)" | df$PUBINJ=="Always (100% of the time)", 2, NA))))
table(df$PUBINJ_3cat, useNA = "ifany")
232+160
185+192
#gender
table(df$GENDER, useNA = "ifany")
table(df$RECSHR, useNA = "ifany")
df.labels$description[df.labels$VAR_ID=="RECSHR"]
df.labels$description[df.labels$VAR_ID=="IJWOTH"]
#Frequency of injecting with others in last 6 months
table(df$IJWOTH, useNA = "ifany")
#arrest
df.labels$description[df.labels$VAR_ID=="ARREST"]
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(lme4)
library(MASS)
library(mice)
library(biostat3)
library(lmtest)
library(gee)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#setwd("~/GitHub/lizzyandshelley/Dataset")  #SHELLEY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
#public injection
table(df$PUBINJ, useNA = "ifany") #Frequency of public injection
#convert to 3 level variable (0 = never, 1 = occasionally/sometimes, 2 = usually/always)
df$PUBINJ_3cat <- as.factor(ifelse(df$PUBINJ=="Never (0% of the time)", 0, ifelse(df$PUBINJ=="Occasionally (less than 25% of the time)" | df$PUBINJ=="Sometimes (25% to 74% of the time)", 1, ifelse(df$PUBINJ=="Usually (75% to 99% of the time)" | df$PUBINJ=="Always (100% of the time)", 2, NA))))
table(df$PUBINJ_3cat, useNA = "ifany")
table(df$RECSHR, useNA = "ifany") #Times used dirty needles last 6 months
#age at baseline (years)
df$AGE <- as.numeric(df$AGE)
table(df$AGE, useNA = "ifany")
#gender
table(df$GENDER, useNA = "ifany")
#homelessness
df$HOMELESS <- as.numeric(df$HOMELESS) #do you consider yourself homeless
df$MOSHOME <- as.numeric(df$MOSHOME) #number of months homeless
table(df$HOMELESS, useNA = "ifany")
table(df$MOSHOME, useNA = "ifany")
#frequency of injecting with others in last 6 months
table(df$IJWOTH, useNA = "ifany")
#crack injection
table(df$CRKINJ, useNA = "ifany")
#powder cocaine injection
table(df$CCINJ, useNA = "ifany")
#meth injection
table(df$MTINJ, useNA = "ifany")
#prescription stimulant injection
table(df$STINJ, useNA = "ifany")
#heroin injection
table(df$HRINJ, useNA = "ifany")
#NMPO injection
table(df$OPINJ, useNA = "ifany")
#alcohol
df$ALCDAY <- as.numeric(df$ALCDAY) #Days of alcohol use in last 30 days
df$ALCTX <- as.numeric(df$ALCTX) #Times you drank on a typical day
df$binge <- ifelse(df$ALCDAY==0, 0, ifelse(df$ALCTX<4, 0, ifelse(df$ALCTX>3, 1, NA))) #binge alcohol on a typical day (>3 drinks)
table(df$ALCDAY, useNA = "ifany")
table(df$ALCTX, useNA = "ifany")
table(df$binge, useNA = "ifany")
#any stimulant injection (composite)
df$ANYSTIM <- ifelse(df$CRKINJ=="Yes" | df$CCINJ=="Yes" | df$MTINJ=="Yes" | df$STINJ=="Yes", 1, ifelse(df$CRKINJ=="No" & df$CCINJ=="No" & df$MTINJ=="No" & df$STINJ=="No", 0, NA))
table(df$ANYSTIM, useNA = "ifany")
#any opioid injection (composite)
df$ANYOPIATE <- ifelse(df$HRINJ=="Yes" | df$OPINJ=="Yes", 1, ifelse(df$HRINJ=="No" & df$OPINJ=="No", 0, NA))
table(df$ANYOPIATE, useNA = "ifany")
df$YRSHOME <- df$MOSHOME/12
table(df$YRSHOME, useNA = "ifany")
#public injection
table(df$PUBINJ, useNA = "ifany") #Frequency of public injection
df.labels$description[df.labels$VAR_ID=="SUMINJ"]
#total number of injections last 30 days (offset term? should I keep this as 30 or multiply by 6?)
df$SUMINJ <- as.numeric(paste(df$SUMINJ))
table(df$SUMINJ, useNA = "ifany")
df.labels$description[df.labels$VAR_ID=="TIMESHARE"]
dfslong$TIMESHARE <- as.numeric(paste(dfslong$TIMESHARE))
table(df$TIMESHARE)
table(df$PUBINJ_3cat, useNA = "ifany")
table(df$SUMINJ, useNA = "ifany")
#subsetting the data to only include people who injected in past 30 days
df <- subset(df, SUMINJ>0)
table(df$RECSHR, useNA = "ifany") #Times used dirty needles last 6 months
modelpoisson <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", data = df, na.action = na.omit)
table(df$RECSHR)
class(df$RECSHR)
df$RECSHR <- as.numeric(df$RECSHR)
modelpoisson <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", data = df, na.action = na.omit)
summary(modelpoisson_baseline)
summary(modelpoisson)
? glm
modelpoisson_offset <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", offset = "SUMINJ", data = df, na.action = na.omit)
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(lme4)
library(MASS)
library(mice)
library(biostat3)
library(lmtest)
library(gee)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#setwd("~/GitHub/lizzyandshelley/Dataset")  #SHELLEY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
#subsetting the data to only include people who injected in past 30 days (only removes 5 ppl)
df <- subset(df, SUMINJ>0)
#public injection
table(df$PUBINJ, useNA = "ifany") #Frequency of public injection (ordinal)
#convert to 3 level variable (0 = never, 1 = occasionally/sometimes, 2 = usually/always)
df$PUBINJ_3cat <- as.factor(ifelse(df$PUBINJ=="Never (0% of the time)", 0, ifelse(df$PUBINJ=="Occasionally (less than 25% of the time)" | df$PUBINJ=="Sometimes (25% to 74% of the time)", 1, ifelse(df$PUBINJ=="Usually (75% to 99% of the time)" | df$PUBINJ=="Always (100% of the time)", 2, NA))))
table(df$PUBINJ_3cat, useNA = "ifany")
table(df$RECSHR, useNA = "ifany") #Times used dirty needles last 6 months
df$RECSHR <- as.numeric(df$RECSHR)
#age at baseline (years)
df$AGE <- as.numeric(df$AGE)
table(df$AGE, useNA = "ifany")
########IF HAVE TO CATEGORIZE AGE BECAUSE NB MODEL WOULDN'T CONVERGE###########
#df$AGE_cat <- as.factor(ifelse(df$AGE<25, "y", ifelse(df$AGE>24 & df$AGE<41, "m", ifelse(df$AGE>40, "e", NA))))
#gender
table(df$GENDER, useNA = "ifany")
#homelessness
df$HOMELESS <- as.numeric(df$HOMELESS) #do you consider yourself homeless
df$MOSHOME <- as.numeric(df$MOSHOME) #number of months homeless
df$YRSHOME <- df$MOSHOME/12
table(df$HOMELESS, useNA = "ifany")
table(df$MOSHOME, useNA = "ifany")
table(df$YRSHOME, useNA = "ifany")
#total number of injections last 30 days (offset term? should I keep this as 30 or multiply by 6?)
df$SUMINJ <- as.numeric(paste(df$SUMINJ))
table(df$SUMINJ, useNA = "ifany")
#frequency of injecting with others in last 6 months
table(df$IJWOTH, useNA = "ifany")
#crack injection
table(df$CRKINJ, useNA = "ifany")
#powder cocaine injection
table(df$CCINJ, useNA = "ifany")
#meth injection
table(df$MTINJ, useNA = "ifany")
#prescription stimulant injection
table(df$STINJ, useNA = "ifany")
#heroin injection
table(df$HRINJ, useNA = "ifany")
#NMPO injection
table(df$OPINJ, useNA = "ifany")
#alcohol
df$ALCDAY <- as.numeric(df$ALCDAY) #Days of alcohol use in last 30 days
df$ALCTX <- as.numeric(df$ALCTX) #Times you drank on a typical day
df$binge <- ifelse(df$ALCDAY==0, 0, ifelse(df$ALCTX<4, 0, ifelse(df$ALCTX>3, 1, NA))) #binge alcohol on a typical day (>3 drinks)
table(df$ALCDAY, useNA = "ifany")
table(df$ALCTX, useNA = "ifany")
table(df$binge, useNA = "ifany")
#any stimulant injection (composite)
df$ANYSTIM <- ifelse(df$CRKINJ=="Yes" | df$CCINJ=="Yes" | df$MTINJ=="Yes" | df$STINJ=="Yes", 1, ifelse(df$CRKINJ=="No" & df$CCINJ=="No" & df$MTINJ=="No" & df$STINJ=="No", 0, NA))
table(df$ANYSTIM, useNA = "ifany")
#any opioid injection (composite)
df$ANYOPIATE <- ifelse(df$HRINJ=="Yes" | df$OPINJ=="Yes", 1, ifelse(df$HRINJ=="No" & df$OPINJ=="No", 0, NA))
table(df$ANYOPIATE, useNA = "ifany")
modelpoisson <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", data = df, na.action = na.omit)
summary(modelpoisson)
modelpoisson_offset <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", offset = "SUMINJ", data = df, na.action = na.omit)
length(df$SUMINJ)
length(df$RECSHR)
? glm.nb
model.nb <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, data = df, na.action = na.omit)
summary(model.nb)
model.nb.offset <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, data = df, offset= "SUMINJ", na.action = na.omit)
modelpoisson_offset <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", offset = "df$SUMINJ", data = df, na.action = na.omit)
modelpoisson_offset <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", offset = df$SUMINJ, data = df, na.action = na.omit)
summary(modelpoisson_offset)
modelpoisson_offset <- glm(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, family = "poisson", offset = df$SUMINJ, data = df, na.action = na.omit)
model.nb.offset <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, data = df, offset= df$SUMINJ, na.action = na.omit)
model.nb.offset <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + binge, data = df, offset= df$SUMINJ, na.action = na.omit)
