tbl.NAL6MOS <- table(df$NAL6MOS, useNA = "ifany")
tbl.NAL6MOS
prop.table(tbl.NAL6MOS)
#NAL6MOSNEW: Creating new variable combining NALEVER AND NAL6MOS so that those who answered "No" to NALEVER are also "No" on NAL6MOS
#crosstab of NALEVER and NAL6MOS
table(df$NALEVER, df$NAL6MOS, useNA = "ifany")
df$NAL6MOS.new <- ifelse(df$NALEVER=="Yes" & df$NAL6MOS=="Yes", 1, ifelse(df$NALEVER=="Yes" & df$NAL6MOS=="No", 0, ifelse(df$NALEVER=="No", 0, NA)))
tbl.NAL6MOS.new <- table(df$NAL6MOS.new, useNA = "ifany")
tbl.NAL6MOS.new
prop.table(tbl.NAL6MOS.new)
#NAL6ORG: Naloxone from whom in the last 6 months
#From whom did you receive naloxone, narcan, intranasal narcan, and/or autoinjector/evzio in the last 6 months?
table(df$NAL6ORG, useNA = "ifany")
table(df$NAL6ORGA, useNA = "ifany") #Needle exchange
table(df$NAL6ORGB, useNA = "ifany") #Another drug user
table(df$NAL6ORGC, useNA = "ifany") #Another community member
table(df$NAL6ORGD, useNA = "ifany") #A family member
table(df$NAL6ORGE, useNA = "ifany") #Pharmacy
table(df$NAL6ORGF, useNA = "ifany") #Community clinic
table(df$NAL6ORGG, useNA = "ifany") #Hospital
table(df$NAL6ORGH, useNA = "ifany") #Jail or prison
table(df$NAL6ORGI, useNA = "ifany") #Other
#OTHNORG: Other organization that provided naloxone in the last 6 months
#What is the other organization or entity that provided you with naloxone in the last 6 months?
table(df$OTHNORG, useNA = "ifany")
#NALUSED:Used naloxone in the last 6 months
#Have you used your Naloxone in the last 6 months?
tbl.NALUSED <- table(df$NALUSED, useNA = "ifany")
tbl.NALUSED
prop.table(tbl.NALUSED)
#NALOSE: Lost naloxone in the last 6 months
#Have you lost your Naloxone in the last 6 months?
tbl.NALOSE <- table(df$NALOSE, useNA = "ifany")
tbl.NALOSE
prop.table(tbl.NALOSE)
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
table(df$NALUSED, df$NALOSE, useNA = "ifany")
df$NALUSEandorLOSE <- ifelse((df$NALUSED=="Yes" | df$NALOSE=="Yes"), 1, 0)
tbl.NALUSEandorLOSE <- table(df$NALUSEandorLOSE, useNA = "ifany")
tbl.NALUSEandorLOSE
prop.table(tbl.NALUSEandorLOSE)
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
tbl.NALFILL <- table(df$NALFILL, useNA = "ifany")
tbl.NALFILL
prop.table(tbl.NALFILL)
#TMEFILL: Days it took to refill or replace naloxone.
#How long after using or losing your Naloxone, did you get a replacement or refill?
tbl.TMEFILL <- table(df$TMEFILL, useNA = "ifany")
tbl.TMEFILL
prop.table(tbl.TMEFILL)
#NALPRVD: Who provided the naloxone replacement or refill
#From whom did you receive your naloxone replacement or refill?
table(df$NALPRVD, useNA = "ifany")
table(df$NALPRVDA, useNA = "ifany") #Needle exchange
table(df$NALPRVDB, useNA = "ifany") #Another drug user
table(df$NALPRVDC, useNA = "ifany") #Another community member
table(df$NALPRVDD, useNA = "ifany") #A family member
table(df$NALPRVDE, useNA = "ifany") #Pharmacy
table(df$NALPRVDF, useNA = "ifany") #Community clinic
table(df$NALPRVDG, useNA = "ifany") #Hospital
table(df$NALPRVDH, useNA = "ifany") #Jail or prison
table(df$NALPRVDI, useNA = "ifany") #Other
#OTHPRON: Replacement naloxone provided by what other organization
#What is the other organization or entity that provided you with naloxone dose replacement or refill?
table(df$OTHPRON, useNA = "ifany") #Other
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
tbl.NALOWN <- table(df$NALOWN, useNA = "ifany")
tbl.NALOWN
prop.table(tbl.NALOWN)
#NALAVAIL: Naloxone available
#In the last 6 months, when you injected drugs, how often did you or someone else around you have naloxone in the event of an overdose?
tbl.NALAVAIL <- table(df$NALAVAIL, useNA = "ifany")
tbl.NALAVAIL
prop.table(tbl.NALAVAIL)
#city
table(df$LOCALID, useNA = "ifany")
#gender (combine other and transgender into other so 3 cat variable)
df$GENDER <- df$GENDER %>% fct_collapse("Other" = c("Transgender","Other"))
table(df$GENDER, useNA = "ifany")
#age
table(df$AGE, useNA = "ifany")
table(df$agecat, useNA = "ifany") #(<30, 30 to 39, 40-49, 50 or more)
#race (recoded into fewer categories)
table(df$RACELG, useNA = "ifany")
df$RACE_cat <- df$RACELG %>% fct_collapse("Other" = c("Native American","Asian/Pacific Islander", "Mixed Race/Other"))
df$RACE_cat <- droplevels(df$RACE_cat, exclude=c("Don't know", "Refused"))
table(df$RACE_cat, useNA = "ifany")
#education (High school education or more)
table(df$ED, useNA = "ifany")
#homelessness (Consider Self Homeless)
table(df$HOMELESS, useNA = "ifany")
#incarceration (Any jail in the last 6 months)
table(df$JAIL, useNA = "ifany")
###SPEEDBALL###
table(df$SB30, useNA = "ifany") #used speedball yes/no (heroin + cocaine or crack)
table(df$SBNINJ, useNA = "ifany")  #any non-injection speedball
table(df$SBX, useNA = "ifany")  #non-injection speedball (# of times)
table(df$SBINJ, useNA = "ifany")  #any injection speedball
table(df$SBIX, useNA = "ifany")  #injection speedball (# of times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$SBX <- as.integer(df$SBX) #change to numeric instead of factor
df$SBIX <- as.integer(df$SBIX) #change to numeric instead of factor
df$SB.freq <-   ifelse(df$SBX>=30 | df$SBIX>=30, 2, ifelse((df$SBX>0 & df$SBX<30) & (df$SBIX>0 & df$SBIX<30), 1,
ifelse(df$SBX==0 & df$SBIX==0, 0, NA)))
df$SB.freq[is.na(df$SB.freq)] <- 0
table(df$SB.freq, useNA = "ifany")
###GOOFBALL###
table(df$GB30, useNA = "ifany")   #used goofball yes/no (heroin + meth)
table(df$GBNINJ, useNA = "ifany")   #any non-injection goofball
table(df$GBX, useNA = "ifany")   #non-injection goofball (# times)
table(df$GBINJ, useNA = "ifany")   #any injection goofball
table(df$GBIX, useNA = "ifany")   #injection goofball (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$GBX <- as.integer(df$GBX) #change to numeric instead of factor
df$GBIX <- as.integer(df$GBIX) #change to numeric instead of factor
df$GB.freq <-   ifelse(df$GBX>=30 | df$GBIX>=30, 2, ifelse((df$GBX>0 & df$GBX<30) & (df$GBIX>0 & df$GBIX<30), 1,
ifelse(df$GBX==0 & df$GBIX==0, 0, NA)))
df$GB.freq[is.na(df$GB.freq)] <- 0
table(df$GB.freq, useNA = "ifany")
###CRACK###
table(df$CRCK30, useNA = "ifany")  #used crack yes/no
table(df$CRKNINJ, useNA = "ifany") #any non-injection crack
table(df$CRCKX, useNA = "ifany")   #non-injection crack (# times)
table(df$CRKINJ, useNA = "ifany") #any injection crack
table(df$CRCKIX, useNA = "ifany") #injection crack (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$CRCKX <- as.integer(df$CRCKX) #change to numeric instead of factor
df$CRCKIX <- as.integer(df$CRCKIX) #change to numeric instead of factor
df$CRCK.freq <-   ifelse(df$CRCKX>=30 | df$CRCKIX>=30, 2, ifelse((df$CRCKX>0 & df$CRCKX<30) & (df$CRCKIX>0 & df$CRCKIX<30), 1,
ifelse(df$CRCKX==0 & df$CRCKIX==0, 0, NA)))
df$CRCK.freq[is.na(df$CRCK.freq)] <- 0
table(df$CRCK.freq, useNA = "ifany")
###COCAINE###
table(df$PCOKE30, useNA = "ifany") #used powder cocaine yes/no
table(df$CCNINJ, useNA = "ifany") #any non-injection powder cocaine
table(df$PCOKEX, useNA = "ifany") #non-injection powder cocaine (times)
table(df$CCINJ, useNA = "ifany")  #any injection powder cocaine
table(df$PCOKEIX, useNA = "ifany") #injection powder cocaine (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$PCOKEX <- as.integer(df$PCOKEX) #change to numeric instead of factor
df$PCOKEIX <- as.integer(df$PCOKEIX) #change to numeric instead of factor
df$PCOKE.freq <-   ifelse(df$PCOKEX>=30 | df$PCOKEIX>=30, 2, ifelse((df$PCOKEX>0 & df$PCOKEX<30) & (df$PCOKEIX>0 & df$PCOKEIX<30), 1,
ifelse(df$PCOKEX==0 & df$PCOKEIX==0, 0, NA)))
df$PCOKE.freq[is.na(df$PCOKE.freq)] <- 0
table(df$PCOKE.freq, useNA = "ifany")
###METHAMPHETAMINE###
table(df$METH30, useNA = "ifany") #used meth yes/no
table(df$MTNINJ, useNA = "ifany") #any non-injection meth
table(df$METHX, useNA = "ifany") #non-injection meth (# times)
table(df$MTINJ, useNA = "ifany") #any injection meth
table(df$METHIX, useNA = "ifany") #injection meth (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$METHX <- as.integer(df$METHX) #change to numeric instead of factor
df$METHIX <- as.integer(df$METHIX) #change to numeric instead of factor
df$METH.freq <-   ifelse(df$METHX>=30 | df$METHIX>=30, 2, ifelse((df$METHX>0 & df$METHX<30) & (df$METHIX>0 & df$METHIX<30), 1,
ifelse(df$METHX==0 & df$METHIX==0, 0, NA)))
df$METH.freq[is.na(df$METH.freq)] <- 0
table(df$METH.freq, useNA = "ifany")
###NONMEDICAL PRESCRIPTION STIMULANT###
table(df$ST30, useNA = "ifany") #used NMPS yes/no
table(df$STNINJ, useNA = "ifany") #any non-injection NMPS
table(df$STX, useNA = "ifany") #non-injection NMPS (# times)
table(df$STINJ, useNA = "ifany") #any injection NMPS
table(df$STIX, useNA = "ifany") #injection NMPS (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$STX <- as.integer(df$STX) #change to numeric instead of factor
df$STIX <- as.integer(df$STIX) #change to numeric instead of factor
df$ST.freq <-   ifelse(df$STX>=30 | df$STIX>=30, 2, ifelse((df$STX>0 & df$STX<30) & (df$STIX>0 & df$STIX<30), 1,
ifelse(df$STX==0 & df$STIX==0, 0, NA)))
df$ST.freq[is.na(df$ST.freq)] <- 0
table(df$ST.freq, useNA = "ifany")
###HEROIN###
table(df$HER30, useNA = "ifany") #used heroin yes/no
table(df$HRNINJ, useNA = "ifany") #any non-injection heroin
table(df$HERX, useNA = "ifany") #non-injection heroin (# times)
table(df$HRINJ, useNA = "ifany") #any injection heroin
table(df$HERIX, useNA = "ifany") #injection heroin (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$HERX <- as.integer(df$HERX) #change to numeric instead of factor
df$HERIX <- as.integer(df$HERIX) #change to numeric instead of factor
df$HER.freq <-   ifelse(df$HERX>=30 | df$HERIX>=30, 2, ifelse((df$HERX>0 & df$HERX<30) & (df$HERIX>0 & df$HERIX<30), 1,
ifelse(df$HERX==0 & df$HERIX==0, 0, NA)))
df$HER.freq[is.na(df$HER.freq)] <- 0
table(df$HER.freq, useNA = "ifany")
###NONMEDICAL PRESCRIPTION OPIOIDS###
table(df$OP30, useNA = "ifany") #used NMPO yes/no
table(df$OPNINJ, useNA = "ifany") #any non-injection NMPO
table(df$OPX, useNA = "ifany") #non-injection NMPO (# times)
table(df$OPINJ, useNA = "ifany") #any injection NMPO
table(df$OPIX, useNA = "ifany") #injection NMPO (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$OPX <- as.integer(df$OPX) #change to numeric instead of factor
df$OPIX <- as.integer(df$OPIX) #change to numeric instead of factor
df$OP.freq <-   ifelse(df$OPX>=30 | df$OPIX>=30, 2, ifelse((df$OPX>0 & df$OPX<30) & (df$OPIX>0 & df$OPIX<30), 1,
ifelse(df$OPX==0 & df$OPIX==0, 0, NA)))
df$OP.freq[is.na(df$OP.freq)] <- 0
table(df$OP.freq, useNA = "ifany")
###METHADONE###
table(df$MD30, useNA = "ifany") #used methadone yes/no
table(df$MDNINJ, useNA = "ifany") #any non-injection methadone
table(df$MDX, useNA = "ifany") #non-injection methadone (# times)
table(df$MDINJ, useNA = "ifany") #any injection methadone
table(df$MDIX, useNA = "ifany") #injection methadone (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$MDX <- as.integer(df$MDX) #change to numeric instead of factor
df$MDIX <- as.integer(df$MDIX) #change to numeric instead of factor
df$MD.freq <-   ifelse(df$MDX>=30 | df$MDIX>=30, 2, ifelse((df$MDX>0 & df$MDX<30) & (df$MDIX>0 & df$MDIX<30), 1,
ifelse(df$MDX==0 & df$MDIX==0, 0, NA)))
df$MD.freq[is.na(df$MD.freq)] <- 0
table(df$MD.freq, useNA = "ifany")
###BUPRENORPHINE###
table(df$BUP30, useNA = "ifany") #used bup yes/no
table(df$BUPNINJ, useNA = "ifany") #any non-injection bup
table(df$BUPX, useNA = "ifany") #non-injection bup (# times)
table(df$BUPINJ, useNA = "ifany") #any injection bup
table(df$BUPIX, useNA = "ifany") #injection bup (# times)
#creating frequency variable (2= greater than or equal to 30 times, 1 = greater than 0 but less than 30, 0 = none)
df$BUPX <- as.integer(df$BUPX) #change to numeric instead of factor
df$BUPIX <- as.integer(df$BUPIX) #change to numeric instead of factor
df$BUP.freq <-   ifelse(df$BUPX>=30 | df$BUPIX>=30, 2, ifelse((df$BUPX>0 & df$BUPX<30) & (df$BUPIX>0 & df$BUPIX<30), 1,
ifelse(df$BUPX==0 & df$BUPIX==0, 0, NA)))
df$BUP.freq[is.na(df$BUP.freq)] <- 0
table(df$BUP.freq, useNA = "ifany")
#FREQUENCY OF STIMULANT USE
#includes crack cocaine, powder cocaine, meth, nonmedical rx stimulants, speedball, and goofball
df$STIM.freq <- ifelse(df$SB.freq==2 | df$GB.freq==2 | df$CRCK.freq==2 | df$PCOKE.freq==2 | df$METH.freq==2 | df$ST.freq==2, 2, ifelse(df$SB.freq==0 & df$GB.freq==0 & df$CRCK.freq==0 & df$PCOKE.freq==0 & df$METH.freq==0 & df$ST.freq==0, 0, 1))
df$STIM.freq <- as.factor(df$STIM.freq)
table(df$STIM.freq, useNA = "ifany")
#FREQUENCY OF OPIOID USE
#includes speedball, goofball, heroin, nonmedical rx opioids, methadone, bup
df$OPIOID.freq <- ifelse(df$SB.freq==2 | df$GB.freq==2 | df$HER.freq==2 | df$OP.freq==2 | df$MD.freq==2 | df$BUP.freq==2, 2, ifelse(df$SB.freq==0 & df$GB.freq==0 & df$HER.freq==0 & df$OP.freq==0 & df$MD.freq==0 & df$BUP.freq==0, 0, 1))
df$OPIOID.freq <- as.factor(df$OPIOID.freq)
table(df$OPIOID.freq, useNA = "ifany")
####ANY STIMULANT USE IN PAST 30 DAYS (injection and/or non-injection composite)###
#includes crack cocaine, powder cocaine, meth, nonmedical rx stimulants, speedball, and goofball
df$ANYSTIMUSE <- ifelse(df$CRKNINJ=="Yes" | df$CCNINJ=="Yes" | df$MTNINJ=="Yes" | df$STNINJ=="Yes" |df$SBNINJ =="Yes" |df$GBNINJ=="Yes" | df$CRKINJ=="Yes" | df$CCINJ=="Yes" | df$MTINJ=="Yes" | df$STINJ=="Yes" |df$SBINJ=="Yes"| df$GBINJ=="Yes", 1, ifelse(df$CRKNINJ=="No" &df$CCNINJ=="No" & df$MTNINJ=="No" & df$STNINJ=="No" & df$SBNINJ=="No" & df$GBNINJ=="No" & df$CRKINJ=="No" &  df$CCINJ=="No" & df$MTINJ=="No" & df$STINJ=="No" & df$SBINJ=="No" & df$GBINJ=="No", 0, NA))
df$ANYSTIMUSE <- as.factor(df$ANYSTIMUSE)
table(df$ANYSTIMUSE, useNA = "ifany")
###ANY OPIOID USE IN PAST 30 DAYS (injection and/or non-injection composite)###
#includes speedball, goofball, heroin, nonmedical rx opioids, methadone, bup
df$ANYOPIOIDUSE <- ifelse(df$SBINJ=="Yes" | df$GBINJ=="Yes" | df$MDINJ=="Yes" | df$BUPINJ=="Yes" | df$HRINJ=="Yes" | df$OPINJ=="Yes" |df$SBNINJ=="Yes" | df$GBNINJ=="Yes" |  df$MDNINJ=="Yes" |  df$BUPNINJ=="Yes" |  df$HRNINJ=="Yes" | df$OPNINJ=="Yes", 1, ifelse(df$SBINJ=="No" & df$GBINJ=="No"  & df$MDINJ=="No"  & df$BUPINJ=="No" & df$HRINJ=="No" & df$OPINJ=="No"  & df$SBNINJ=="No" & df$GBNINJ=="No"  & df$MDNINJ=="No"  & df$BUPNINJ=="No" & df$HRNINJ=="No" & df$OPNINJ=="No", 0, NA))
df$ANYOPIOIDUSE <- as.factor(df$ANYOPIOIDUSE)
table(df$ANYOPIOIDUSE, useNA = "ifany")
#overdose witnessed (witnessed an overdose in the last 6 months)
table(df$WOD6M, useNA = "ifany")
#personal overdose history (Overdosed in the last 6 months)
table(df$ODP6M, useNA = "ifany")
#TX6MOS: Any alcohol or drug treatment in the last 6 months
table(df$TX6MOS, useNA = "ifany")
#Methadone detoxification in the last 6 moths.
table(df$DRGTXA, useNA = "ifany")
#Methadone maintenance in the last 6 moths.
table(df$DRGTXB, useNA = "ifany")
#Buprenorphine in the last 6 moths.
table(df$DRGTXC, useNA = "ifany")
#DRGTXD: Outpatient treatment in the last 6 moths
table(df$DRGTXD, useNA = "ifany")
#DRGTXE: Inpatient hospital treatment in the last 6 moths
table(df$DRGTXE, useNA = "ifany")
#DRGTXF: Residential treatment in the last 6 moths
table(df$DRGTXF, useNA = "ifany")
View(df.labels)
#Buprenorphine in the last 6 moths.
table(df$DRGTXC, useNA = "ifany")
table(df$BUPETX, useNA = "ifany")
161+358
df.labels$description[df.labels$VAR_ID=="DETOX"]
df.labels$description[df.labels$VAR_ID=="MAINTN"]
df.labels$description[df.labels$VAR_ID=="BUPETX"]
#TX6MOS: Any alcohol or drug treatment in the last 6 months
table(df$TX6MOS, useNA = "ifany")
#DRGTXA: Methadone detoxification in the last 6 moths.
table(df$DRGTXA, useNA = "ifany")
#DETOX: Methadone detox in the last 6 months with missings as nos
table(df$DETOX, useNA = "ifany")
158+358
#DRGTXB: Methadone maintenance in the last 6 moths.
table(df$DRGTXB, useNA = "ifany")
#MAINTN: Methadone maintenance in the last 6 months with missings as nos
table(df$MAINTN, useNA = "ifany")
46+358
#DRGTXC: Buprenorphine in the last 6 moths.
table(df$DRGTXC, useNA = "ifany")
#BUPETX: Buprenorphine treatment in the last 6 months recoded
table(df$BUPETX, useNA = "ifany")
161+358
table(df$TXNON, useNA = "ifany")
table(df$TXNOW, useNA = "ifany")
mytable <- table(df$DETOX, df$MAINTN, df$BUPETX)
ftable(mytable)
#Any OAT in the past six months
df$OAT6month <- ifelse(df$DETOX=="Yes" | df$MAINTN=="Yes" | df$BUPETX=="Yes", 1, 0, NA)
#Any OAT in the past six months
df$OAT6month <- ifelse(df$DETOX=="Yes" | df$MAINTN=="Yes" | df$BUPETX=="Yes", 1, 0)
df$OAT6month_withNA <- ifelse(df$DRGTXA=="Yes" | df$DRGTXB=="Yes" | df$DRGTXC=="Yes", 1, 0, NA)
table(df$OAT6month, useNA = "ifany")
20+132+17
#DRGTXA: Methadone detoxification in the last 6 moths.
table(df$DRGTXA, useNA = "ifany")
#DRGTXB: Methadone maintenance in the last 6 moths.
table(df$DRGTXB, useNA = "ifany")
table(df$OAT6month, useNA = "ifany")
20+132+17
#TXNOW:Currently in drug treatment
table(df$TXNOW, useNA = "ifany")
#TX6MOS: Any alcohol or drug treatment in the last 6 months
table(df$TX6MOS, useNA = "ifany")
#TXNOW:Currently in drug treatment
table(df$TXNOW, useNA = "ifany")
#TXNOW:Currently in drug treatment
table(df$TXNOW, useNA = "ifany")
#CURTX: Current treatment enrollment
table(df$CURTX, useNA = "ifany")
table(df$ANYTX, useNA = "ifany")
myVars <- c("LOCALID", "GENDER","agecat","RACE_cat", "ED","HOMELESS", "JAIL", "STIM.freq", "OPIOID.freq", "WOD6M", "ODP6M", "OAT6month")
# Specify which of the variables are categorical
catVars <- c("LOCALID", "GENDER", "agecat", "RACE_cat", "ED","HOMELESS", "JAIL", "STIM.freq", "OPIOID.freq", "WOD6M", "ODP6M", "OAT6month")
# Create an overall table 1
#REMINDER THAT TABLE1 PACKAGE DOES WEIRD STUFF WITH MISSING, SO CHECK N (PERCENTAGE) WITH CROSSTABS
table1.overall <- CreateTableOne(vars= myVars,
data= df,
factorVars = catVars)
print(table1.overall, showAllLevels = TRUE, missing = FALSE)
table1byNAL6MOS.new <- CreateTableOne(vars=myVars,
data=df,
factorVars = catVars,
strata="NAL6MOS.new")
print(table1byNAL6MOS.new, showAllLevels = TRUE, test=TRUE, missing = FALSE)
#glm(NAL6MOS.new ~ factor(GENDER), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(agecat), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(RACE_cat), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(ED), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(HOMELESS), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(JAIL), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(STIM.freq), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(OPIOID.freq), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(WOD6M), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(ODP6M), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(OAT6MONTH), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(GENDER), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(agecat), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(RACE_cat), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(ED), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(HOMELESS), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(JAIL), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(STIM.freq), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(OPIOID.freq), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(WOD6M), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(ODP6M), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(OAT6month), data=df, family=binomial(log))
#use geepack because modified poisson is picky
require(geepack)
#use geepack because modified poisson is picky
require(geepack)
df.modpoiss <- subset(df, select=c(SUBJECT, NAL6MOS.new, LOCALID, GENDER, agecat, RACE_cat, ED, HOMELESS, JAIL, STIM.freq, OPIOID.freq, WOD6M, ODP6M, OAT6month))
df.modpoiss <- na.omit(df.modpoiss)
OATbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(OAT6month), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
exp(coef(OATbynal6mos.modpoiss))
OATbynal6mos.modpoiss.RR.coefci.adj <- cbind(OATbynal6mos.modpoiss$coefficients, confint.default(OATbynal6mos.modpoiss))
OATbynal6mos.modpoiss.RR.expci.adj <- exp(OATbynal6mos.modpoiss.RR.coefci.adj)
OATbynal6mos.modpoiss.RR.expci.adj
round(OATbynal6mos.modpoiss.RR.expci.adj, 2)
fitnal6mos.modpoiss  <- geeglm(formula=NAL6MOS.new ~ factor(LOCALID) + factor(GENDER) + factor(agecat) + factor(RACE_cat) + factor(ED) + factor(HOMELESS) + factor(JAIL) + factor(STIM.freq) + factor(OPIOID.freq) + factor(WOD6M) + factor(ODP6M) + factor(OAT6month), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(fitnal6mos.modpoiss)
#extract the coefficients and confidence intervals, exponentiate to get RR and 95% CI (using confint.default)
fitnal6mos.RR.coefci.adj <- cbind(fitnal6mos.modpoiss$coefficients, confint.default(fitnal6mos.modpoiss))
fitnal6mos.RR.expci.adj <- exp(fitnal6mos.RR.coefci.adj)
fitnal6mos.RR.expci.adj
round(fitnal6mos.RR.expci.adj, 2)
OAT6monthbynal6mos.modpoiss.RR.coefci.adj <- cbind(OAT6monthbynal6mos.modpoiss$coefficients, confint.default(OAT6monthbynal6mos.modpoiss))
#OAT6month
OAT6monthbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(OAT6month), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(OAT6monthbynal6mos.modpoiss)
exp(coef(OAT6monthbynal6mos.modpoiss))
#95% CI for OAT6month
OAT6monthbynal6mos.modpoiss.RR.coefci.adj <- cbind(OAT6monthbynal6mos.modpoiss$coefficients, confint.default(OAT6monthbynal6mos.modpoiss))
OAT6monthbynal6mos.modpoiss.RR.expci.adj <- exp(OAT6monthbynal6mos.modpoiss.RR.coefci.adj)
OAT6monthbynal6mos.modpoiss.RR.expci.adj
#rounded to two decimal places
round(OAT6monthbynal6mos.modpoiss.RR.expci.adj, 2)
print(table1byNAL6MOS.new, showAllLevels = TRUE, test=TRUE, missing = FALSE)
#subset the data to those who have received naloxone in the last 6 mos
df_nal6mos <- subset(df, NAL6MOS.new == 1) #N = 265 who have received naloxone in the last 6 mos
table1.subset.receivednal6mos <- CreateTableOne(vars= myVars,
data= df_nal6mos,
factorVars = catVars)
print(table1.subset.receivednal6mos, showAllLevels = TRUE, missing = FALSE)
table1byNALOWN <- CreateTableOne(vars=myVars,
data=df_nal6mos,
factorVars = catVars,
strata="NALOWN")
print(table1byNALOWN, showAllLevels = TRUE, missing = FALSE)
#OAT6month
OAT6monthbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(OAT6month), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
#require geepack because modified poisson is picky
require(geepack)
#subset the data with complete observations because geepack is picky (N= 259)
df.modpoiss.nalown <- subset(df_nal6mos, select=c(SUBJECT, NALOWN, LOCALID, GENDER, agecat, RACE_cat, ED, HOMELESS, JAIL, STIM.freq, OPIOID.freq, WOD6M, ODP6M, OAT6month))
df.modpoiss.nalown <- na.omit(df.modpoiss.nalown)
#recode NALOWN as binary numeric since factor isn't working
df.modpoiss.nalown$NALOWN.binary<-ifelse(df.modpoiss.nalown$NALOWN=='Yes', 1,0)
#OAT6month
OAT6monthbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(OAT6month), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(OAT6monthbynalown.modpoiss)
exp(coef(OAT6monthbynalown.modpoiss))
#95% CI for OAT6month
OAT6monthbynalown.modpoiss.RR.coefci.adj <- cbind(OAT6monthbynalown.modpoiss$coefficients, confint.default(OAT6monthbynalown.modpoiss))
OAT6monthbynalown.modpoiss.RR.expci.adj <- exp(OAT6monthbynalown.modpoiss.RR.coefci.adj)
OAT6monthbynalown.modpoiss.RR.expci.adj
#rounded to two decimal places
round(OAT6monthbynalown.modpoiss.RR.expci.adj, 2)
fitnalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(LOCALID) + factor(GENDER) + factor(agecat) + factor(RACE_cat) + factor(ED) + factor(HOMELESS) + factor(JAIL) + factor(STIM.freq) + factor(OPIOID.freq) + factor(WOD6M) + factor(ODP6M) + factor(OAT6month), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(fitnalown.modpoiss)
exp(coef(fitnalown.modpoiss))
fitnalown.RR.coefci.adj <- cbind(fitnalown.modpoiss$coefficients, confint.default(fitnalown.modpoiss))
fitnalown.RR.expci.adj <- exp(fitnalown.RR.coefci.adj)
fitnalown.RR.expci.adj
round(fitnalown.RR.expci.adj, 2)
#rounded to two decimal places
round(WOD6Mbynal6mos.modpoiss.RR.expci.adj, 2)
#WOD6M
WOD6Mbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(WOD6M), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(WOD6Mbynal6mos.modpoiss)
exp(coef(WOD6Mbynal6mos.modpoiss))
#95% CI for WOD6M
WOD6Mbynal6mos.modpoiss.RR.coefci.adj <- cbind(WOD6Mbynal6mos.modpoiss$coefficients, confint.default(WOD6Mbynal6mos.modpoiss))
WOD6Mbynal6mos.modpoiss.RR.expci.adj <- exp(WOD6Mbynal6mos.modpoiss.RR.coefci.adj)
WOD6Mbynal6mos.modpoiss.RR.expci.adj
#rounded to two decimal places
round(WOD6Mbynal6mos.modpoiss.RR.expci.adj, 2)
#ODP6M
ODP6Mbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ODP6M), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(ODP6Mbynal6mos.modpoiss)
exp(coef(ODP6Mbynal6mos.modpoiss))
#95% CI for ODP6M
ODP6Mbynal6mos.modpoiss.RR.coefci.adj <- cbind(ODP6Mbynal6mos.modpoiss$coefficients, confint.default(ODP6Mbynal6mos.modpoiss))
ODP6Mbynal6mos.modpoiss.RR.expci.adj <- exp(ODP6Mbynal6mos.modpoiss.RR.coefci.adj)
ODP6Mbynal6mos.modpoiss.RR.expci.adj
#rounded to two decimal places
round(ODP6Mbynal6mos.modpoiss.RR.expci.adj, 2)
#OAT6month
OAT6monthbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(OAT6month), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(OAT6monthbynal6mos.modpoiss)
exp(coef(OAT6monthbynal6mos.modpoiss))
#95% CI for OAT6month
OAT6monthbynal6mos.modpoiss.RR.coefci.adj <- cbind(OAT6monthbynal6mos.modpoiss$coefficients, confint.default(OAT6monthbynal6mos.modpoiss))
OAT6monthbynal6mos.modpoiss.RR.expci.adj <- exp(OAT6monthbynal6mos.modpoiss.RR.coefci.adj)
OAT6monthbynal6mos.modpoiss.RR.expci.adj
#rounded to two decimal places
round(OAT6monthbynal6mos.modpoiss.RR.expci.adj, 2)
#rounded to two decimal places
round(WOD6Mbynal6mos.modpoiss.RR.expci.adj, 2)
#rounded to two decimal places
round(ODP6Mbynal6mos.modpoiss.RR.expci.adj, 2)
#rounded to two decimal places
round(OAT6monthbynal6mos.modpoiss.RR.expci.adj, 2)
WOD6Mbynal6mos.modpoiss.RR.expci.adj
summary(WOD6Mbynal6mos.modpoiss)
exp(coef(WOD6Mbynal6mos.modpoiss))
summary(OAT6monthbynal6mos.modpoiss)
#OAT6month
OAT6monthbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(OAT6month), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(OAT6monthbynalown.modpoiss)
exp(coef(OAT6monthbynalown.modpoiss))
#95% CI for OAT6month
OAT6monthbynalown.modpoiss.RR.coefci.adj <- cbind(OAT6monthbynalown.modpoiss$coefficients, confint.default(OAT6monthbynalown.modpoiss))
OAT6monthbynalown.modpoiss.RR.expci.adj <- exp(OAT6monthbynalown.modpoiss.RR.coefci.adj)
OAT6monthbynalown.modpoiss.RR.expci.adj
#rounded to two decimal places
round(OAT6monthbynalown.modpoiss.RR.expci.adj, 2)
chisq.test(table(df$LOCALID, df$NALEVER))
chisq.test(table(df$LOCALID, df$NAL6MOS.new))
chisq.test(table(df$LOCALID, df$NALOWN))
chisq.test(table(df$LOCALID, df$NALUSEandorLOSE))
chisq.test(table(df$LOCALID, df$NALFILL))
chisq.test(table(df$RACE_cat, df$NALEVER))
chisq.test(table(df$RACE_cat, df$NAL6MOS.new))
chisq.test(table(df$RACE_cat, df$NALOWN))
chisq.test(table(df$RACE_cat, df$NALUSEandorLOSE))
chisq.test(table(df$RACE_cat, df$NALFILL))
chisq.test(table(df$LOCALID, df$NALEVER))
chisq.test(table(df$LOCALID, df$NAL6MOS.new))
chisq.test(table(df$LOCALID, df$NALOWN))
chisq.test(table(df$LOCALID, df$NALUSEandorLOSE))
chisq.test(table(df$LOCALID, df$NALFILL))
chisq.test(table(df$RACE_cat, df$NALEVER))
chisq.test(table(df$RACE_cat, df$NAL6MOS.new))
chisq.test(table(df$RACE_cat, df$NALOWN))
chisq.test(table(df$RACE_cat, df$NALUSEandorLOSE))
chisq.test(table(df$RACE_cat, df$NALFILL))
round(prop.table(table(df$LOCALID, df$NAL6MOS.new, useNA = "ifany"),2),3)
round(prop.table(table(df$LOCALID, df$NAL6MOS.new, useNA = "ifany"),1),3)
chisq.test(df$LOCALID, df$NALEVER, correct=FALSE)
#differences by city
chisq.test(table(df$LOCALID, df$NALEVER))
chisq.test(table(df$LOCALID, df$NALEVER))
chisq.test(table(df$LOCALID, df$NALEVER), correct=F)
chisq.test(table(df$LOCALID, df$NAL6MOS.new))
chisq.test(table(df$LOCALID, df$NAL6MOS.new), correct=F)
chisq.test(table(df$LOCALID, df$NALOWN))
chisq.test(table(df$LOCALID, df$NALOWN), correct = F)
chisq.test(table(df$LOCALID, df$NALUSEandorLOSE))
chisq.test(table(df$LOCALID, df$NALUSEandorLOSE), correct = F)
chisq.test(table(df$LOCALID, df$NALFILL))
chisq.test(table(df$LOCALID, df$NALFILL), correct=F)
265-196
.672*196
.672*196
132+69
