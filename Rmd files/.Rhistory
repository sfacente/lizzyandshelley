tbl.NALEVER
prop.table(tbl.NALEVER)
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
tbl.NAL6MOS <- table(df$NAL6MOS, useNA = "ifany")
tbl.NAL6MOS
prop.table(tbl.NAL6MOS)
#NAL6MOSNEW: Creating new variable combining NALEVER AND NAL6MOS so that those who answered "No" to NALEVER are also "No" on NAL6MOS
#crosstab of NALEVER and NAL6MOS
table(df$NALEVER, df$NAL6MOS, useNA = "ifany")
df$NAL6MOS.new <- ifelse(df$NALEVER=="Yes" & df$NAL6MOS=="Yes", 1, ifelse(df$NALEVER=="Yes" & df$NAL6MOS=="No", 0, ifelse(df$NALEVER=="No", 0, NA)))
tbl.NAL6MOS.new <- table(df$NAL6MOS.new, useNA = "ifany")
tbl.NAL6MOS.new
prop.table(tbl.NAL6MOS.new)
#NAL6ORG: Naloxone from whom in the last 6 months
#From whom did you receive naloxone, narcan, intranasal narcan, and/or autoinjector/evzio in the last 6 months?
table(df$NAL6ORG, useNA = "ifany")
table(df$NAL6ORGA, useNA = "ifany") #Needle exchange
table(df$NAL6ORGB, useNA = "ifany") #Another drug user
table(df$NAL6ORGC, useNA = "ifany") #Another community member
table(df$NAL6ORGD, useNA = "ifany") #A family member
table(df$NAL6ORGE, useNA = "ifany") #Pharmacy
table(df$NAL6ORGF, useNA = "ifany") #Community clinic
table(df$NAL6ORGG, useNA = "ifany") #Hospital
table(df$NAL6ORGH, useNA = "ifany") #Jail or prison
table(df$NAL6ORGI, useNA = "ifany") #Other
#OTHNORG: Other organization that provided naloxone in the last 6 months
#What is the other organization or entity that provided you with naloxone in the last 6 months?
table(df$OTHNORG, useNA = "ifany")
#NALUSED:Used naloxone in the last 6 months
#Have you used your Naloxone in the last 6 months?
tbl.NALUSED <- table(df$NALUSED, useNA = "ifany")
tbl.NALUSED
prop.table(tbl.NALUSED)
#NALOSE: Lost naloxone in the last 6 months
#Have you lost your Naloxone in the last 6 months?
tbl.NALOSE <- table(df$NALOSE, useNA = "ifany")
tbl.NALOSE
prop.table(tbl.NALOSE)
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
table(df$NALUSED, df$NALOSE, useNA = "ifany")
df$NALUSEandorLOSE <- ifelse((df$NALUSED=="Yes" | df$NALOSE=="Yes"), 1, 0)
tbl.NALUSEandorLOSE <- table(df$NALUSEandorLOSE, useNA = "ifany")
tbl.NALUSEandorLOSE
prop.table(tbl.NALUSEandorLOSE)
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
tbl.NALFILL <- table(df$NALFILL, useNA = "ifany")
tbl.NALFILL
prop.table(tbl.NALFILL)
#TMEFILL: Days it took to refill or replace naloxone.
#How long after using or losing your Naloxone, did you get a replacement or refill?
tbl.TMEFILL <- table(df$TMEFILL, useNA = "ifany")
tbl.TMEFILL
prop.table(tbl.TMEFILL)
#NALPRVD: Who provided the naloxone replacement or refill
#From whom did you receive your naloxone replacement or refill?
table(df$NALPRVD, useNA = "ifany")
table(df$NALPRVDA, useNA = "ifany") #Needle exchange
table(df$NALPRVDB, useNA = "ifany") #Another drug user
table(df$NALPRVDC, useNA = "ifany") #Another community member
table(df$NALPRVDD, useNA = "ifany") #A family member
table(df$NALPRVDE, useNA = "ifany") #Pharmacy
table(df$NALPRVDF, useNA = "ifany") #Community clinic
table(df$NALPRVDG, useNA = "ifany") #Hospital
table(df$NALPRVDH, useNA = "ifany") #Jail or prison
table(df$NALPRVDI, useNA = "ifany") #Other
#OTHPRON: Replacement naloxone provided by what other organization
#What is the other organization or entity that provided you with naloxone dose replacement or refill?
table(df$OTHPRON, useNA = "ifany") #Other
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
tbl.NALOWN <- table(df$NALOWN, useNA = "ifany")
tbl.NALOWN
prop.table(tbl.NALOWN)
#NALAVAIL: Naloxone available
#In the last 6 months, when you injected drugs, how often did you or someone else around you have naloxone in the event of an overdose?
tbl.NALAVAIL <- table(df$NALAVAIL, useNA = "ifany")
tbl.NALAVAIL
prop.table(tbl.NALAVAIL)
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
tbl.NALEVER
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#tbl.NAL6MOS
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
tbl.NAL6MOS.new
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
tbl.NALOWN
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
tbl.NALEVER
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#tbl.NAL6MOS
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
tbl.NAL6MOS.new
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
tbl.NALOWN
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
tbl.NALEVER
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#tbl.NAL6MOS
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
tbl.NAL6MOS.new
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
tbl.NALOWN
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
tbl.NALUSEandorLOSE
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
tbl.NALFILL
df_SF <- subset(df, LOCALID == "San Francisco")
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
table(df_SF$NALEVER, useNA = "ifany")
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#table(df_SF$NAL6MOS, useNA = "ifany")
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
df_SF$NAL6MOS.new <- ifelse(df_SF$NALEVER=="Yes" & df_SF$NAL6MOS=="Yes", 1, ifelse(df_SF$NALEVER=="Yes" & df_SF$NAL6MOS=="No", 0, ifelse(df_SF$NALEVER=="No", 0, NA)))
table(df_SF$NAL6MOS.new, useNA = "ifany")
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
table(df_SF$NALOWN, useNA = "ifany")
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
df_SF$NALUSEandorLOSE <- ifelse((df_SF$NALUSED=="Yes" | df_SF$NALOSE=="Yes"), 1, 0)
table(df_SF$NALUSEandorLOSE, useNA = "ifany")
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
table(df_SF$NALFILL, useNA = "ifany")
df_LA <- subset(df, LOCALID == "Los Angeles")
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
table(df_LA$NALEVER, useNA = "ifany")
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#table(df_LA$NAL6MOS, useNA = "ifany")
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
df_LA$NAL6MOS.new <- ifelse(df_LA$NALEVER=="Yes" & df_LA$NAL6MOS=="Yes", 1, ifelse(df_LA$NALEVER=="Yes" & df_LA$NAL6MOS=="No", 0, ifelse(df_LA$NALEVER=="No", 0, NA)))
table(df_LA$NAL6MOS.new, useNA = "ifany")
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
table(df_LA$NALOWN, useNA = "ifany")
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
df_LA$NALUSEandorLOSE <- ifelse((df_LA$NALUSED=="Yes" | df_LA$NALOSE=="Yes"), 1, 0)
table(df_LA$NALUSEandorLOSE, useNA = "ifany")
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
table(df_LA$NALFILL, useNA = "ifany")
df_men <- subset(df, GENDER == "Male")
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
table(df_men$NALEVER, useNA = "ifany")
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#table(df_men$NAL6MOS, useNA = "ifany")
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
df_men$NAL6MOS.new <- ifelse(df_men$NALEVER=="Yes" & df_men$NAL6MOS=="Yes", 1, ifelse(df_men$NALEVER=="Yes" & df_men$NAL6MOS=="No", 0, ifelse(df_men$NALEVER=="No", 0, NA)))
table(df_men$NAL6MOS.new, useNA = "ifany")
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
table(df_men$NALOWN, useNA = "ifany")
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
df_men$NALUSEandorLOSE <- ifelse((df_men$NALUSED=="Yes" | df_men$NALOSE=="Yes"), 1, 0)
table(df_men$NALUSEandorLOSE, useNA = "ifany")
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
table(df_men$NALFILL, useNA = "ifany")
df_women <- subset(df, GENDER == "Female")
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
table(df_women$NALEVER, useNA = "ifany")
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#table(df_women$NAL6MOS, useNA = "ifany")
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
df_women$NAL6MOS.new <- ifelse(df_women$NALEVER=="Yes" & df_women$NAL6MOS=="Yes", 1, ifelse(df_women$NALEVER=="Yes" & df_women$NAL6MOS=="No", 0, ifelse(df_women$NALEVER=="No", 0, NA)))
table(df_women$NAL6MOS.new, useNA = "ifany")
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
table(df_women$NALOWN, useNA = "ifany")
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
df_women$NALUSEandorLOSE <- ifelse((df_women$NALUSED=="Yes" | df_women$NALOSE=="Yes"), 1, 0)
table(df_women$NALUSEandorLOSE, useNA = "ifany")
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
table(df_women$NALFILL, useNA = "ifany")
df_unhoused <- subset(df, HOMELESS == "Yes")
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
table(df_unhoused$NALEVER, useNA = "ifany")
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#table(df_unhoused$NAL6MOS, useNA = "ifany")
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
df_unhoused$NAL6MOS.new <- ifelse(df_unhoused$NALEVER=="Yes" & df_unhoused$NAL6MOS=="Yes", 1, ifelse(df_unhoused$NALEVER=="Yes" & df_unhoused$NAL6MOS=="No", 0, ifelse(df_unhoused$NALEVER=="No", 0, NA)))
table(df_unhoused$NAL6MOS.new, useNA = "ifany")
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
table(df_unhoused$NALOWN, useNA = "ifany")
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
df_unhoused$NALUSEandorLOSE <- ifelse((df_unhoused$NALUSED=="Yes" | df_unhoused$NALOSE=="Yes"), 1, 0)
table(df_unhoused$NALUSEandorLOSE, useNA = "ifany")
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
table(df_unhoused$NALFILL, useNA = "ifany")
df_housed <- subset(df, HOMELESS == "No")
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
table(df_housed$NALEVER, useNA = "ifany")
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
#table(df_housed$NAL6MOS, useNA = "ifany")
#NAL6MOS.new: Received naloxone in the last 6 months (combined NALEVER and NAL6MOS to make NAL6MOS.new)
#Have you received naloxone in the last 6 months?
df_housed$NAL6MOS.new <- ifelse(df_housed$NALEVER=="Yes" & df_housed$NAL6MOS=="Yes", 1, ifelse(df_housed$NALEVER=="Yes" & df_housed$NAL6MOS=="No", 0, ifelse(df_housed$NALEVER=="No", 0, NA)))
table(df_housed$NAL6MOS.new, useNA = "ifany")
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
table(df_housed$NALOWN, useNA = "ifany")
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
df_housed$NALUSEandorLOSE <- ifelse((df_housed$NALUSED=="Yes" | df_housed$NALOSE=="Yes"), 1, 0)
table(df_housed$NALUSEandorLOSE, useNA = "ifany")
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
table(df_housed$NALFILL, useNA = "ifany")
View(df.labels)
table(df$yrsinj, useNA = "ifany")
table(df$injyrcat, useNA = "ifany")
table(df$Hiinj, useNA = "ifany")
table(df$HIOPIOID, useNA = "ifany")
table(df$NAL6MOS.new, useNA = "ifany")
glm(NAL6MOS.new ~ factor(LOCALID), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(LOCALID), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(GENDER), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(agecat), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(ED), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(HOMELESS), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(JAIL), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(ANYSTIMINJ), data=df, family=binomial(log))
#city
table(df$LOCALID, useNA = "ifany")
#gender (combine other and transgender into other so 3 cat variable)
df$GENDER <- df$GENDER %>% fct_collapse("Other" = c("Transgender","Other"))
table(df$GENDER, useNA = "ifany")
#age
table(df$AGE, useNA = "ifany")
table(df$agecat, useNA = "ifany") #(<30, 30 to 39, 40-49, 50 or more) MAY WANT TO RECUT THESE MYSELF
#education (High school education or more)
table(df$ED, useNA = "ifany")
#homelessness (Consider Self Homeless)
table(df$HOMELESS, useNA = "ifany")
#incarceration (Any jail in the last 6 months)
table(df$JAIL, useNA = "ifany")
#users of certain injection drugs
table(df$CRKINJ, useNA = "ifany") #crack injection
table(df$CCINJ, useNA = "ifany") #powder cocaine injection
table(df$MTINJ, useNA = "ifany") #meth injection
table(df$STINJ, useNA = "ifany") #prescription stimulant injection
table(df$HRINJ, useNA = "ifany") #heroin injection
table(df$OPINJ, useNA = "ifany") #NMPO injection
#any stimulant injection (composite)
df$ANYSTIMINJ <- ifelse(df$CRKINJ=="Yes" | df$CCINJ=="Yes" | df$MTINJ=="Yes" | df$STINJ=="Yes", 1, ifelse(df$CRKINJ=="No" & df$CCINJ=="No" & df$MTINJ=="No" & df$STINJ=="No", 0, NA))
df$ANYSTIMINJ <- as.factor(df$ANYSTIMINJ)
table(df$ANYSTIMINJ, useNA = "ifany")
#any opioid injection (composite)
df$ANYOPIATEINJ <- ifelse(df$HRINJ=="Yes" | df$OPINJ=="Yes", 1, ifelse(df$HRINJ=="No" & df$OPINJ=="No", 0, NA))
df$ANYOPIATEINJ <- as.factor(df$ANYOPIATEINJ)
table(df$ANYOPIATEINJ, useNA = "ifany")
#overdose witnessed (witnessed an overdose in the last 6 months)
table(df$WOD6M, useNA = "ifany")
#personal overdose history (Overdosed in the last 6 months)
table(df$ODP6M, useNA = "ifany")
glm(NAL6MOS.new ~ factor(LOCALID), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(GENDER), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(agecat), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(ED), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(HOMELESS), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(JAIL), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(ANYSTIMINJ), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(ANYOPIATEINJ), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(WOD6M), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(ODP6M), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(LOCALID) + factor(GENDER) + factor(agecat) + factor(ED) + factor(HOMELESS) + factor(JAIL) + factor(ANYSTIMINJ) + factor(ANYOPIATEINJ) + factor(WOD6M) + factor(ODP6M), data=df, family=binomial(log))
# Identify the variables of interest
myVars <- c("LOCALID", "GENDER","agecat","ED","HOMELESS", "JAIL", "ANYSTIMINJ", "ANYOPIATEINJ", "WOD6M", "ODP6M")
# Specify which of the variables are categorical
catVars <- c("LOCALID", "GENDER", "agecat", "ED","HOMELESS", "JAIL", "ANYSTIMINJ", "ANYOPIATEINJ", "WOD6M", "ODP6M")
# Create an overall table 1
#REMINDER THAT TABLE1 PACKAGE DOES WEIRD STUFF WITH MISSING, SO CHECK N (PERCENTAGE) WITH CROSSTABS
table1.overall <- CreateTableOne(vars= myVars,
data= df,
factorVars = catVars)
print(table1.overall, showAllLevels = TRUE, missing = FALSE)
# Create a table 1 stratified by ever receiving naloxone (1 = ever received, 0 = never received)
##REMINDER THAT TABLE1 PACKAGE DOES WEIRD STUFF WITH MISSING, SO CHECK N (PERCENTAGE) WITH CROSSTABS
table1byNAL6MOS.new <- CreateTableOne(vars=myVars,
data=df,
factorVars = catVars,
strata="NAL6MOS.new")
print(table1byNAL6MOS.new, showAllLevels = TRUE, test=TRUE, missing = FALSE)
require(geepack)
#subset the data with complete observations because geepack is picky
df.modpoiss <- subset(df, select=c(SUBJECT, NAL6MOS.new, LOCALID, GENDER, agecat, ED, HOMELESS, JAIL, ANYSTIMINJ, ANYOPIATEINJ, WOD6M, ODP6M))
df.modpoiss <- na.omit(df.modpoiss)
geeglm(formula=NAL6MOS.new ~ factor(LOCALID), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
#CITY
localIDbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(LOCALID), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(localIDbynal6mos.modpoiss)
exp(coef(localIDbynal6mos.modpoiss))
#GENDER
genderbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(GENDER), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(genderbynal6mos.modpoiss)
exp(coef(genderbynal6mos.modpoiss))
#agecat
agecatbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(agecat), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(agecatbynal6mos.modpoiss)
exp(coef(agecatbynal6mos.modpoiss))
#ED
edbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ED), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(edbynal6mos.modpoiss)
exp(coef(edbynal6mos.modpoiss))
#HOMELESS
homelessbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(HOMELESS), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(homelessbynal6mos.modpoiss)
exp(coef(homelessbynal6mos.modpoiss))
#JAIL
jailbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(JAIL), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(jailbynal6mos.modpoiss)
exp(coef(jailbynal6mos.modpoiss))
#ANYSTIMINJ
anystiminjbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ANYSTIMINJ), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anystiminjbynal6mos.modpoiss)
exp(coef(anystiminjbynal6mos.modpoiss))
#ANYOPIATEINJ
anyopiateinjbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ANYOPIATEINJ), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anyopiateinjbynal6mos.modpoiss)
exp(coef(anyopiateinjbynal6mos.modpoiss))
#WOD6M
WOD6Mbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(WOD6M), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(WOD6Mbynal6mos.modpoiss)
exp(coef(WOD6Mbynal6mos.modpoiss))
#ODP6M
ODP6Mbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ODP6M), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(ODP6Mbynal6mos.modpoiss)
exp(coef(ODP6Mbynal6mos.modpoiss))
#multivariate modified poisson model
fitnal6mos.modpoiss  <- geeglm(formula=NAL6MOS.new ~ factor(LOCALID) + factor(GENDER) + factor(agecat) + factor(ED) + factor(HOMELESS) + factor(JAIL) + factor(ANYSTIMINJ) + factor(ANYOPIATEINJ) + factor(WOD6M) + factor(ODP6M), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(fitnal6mos.modpoiss)
#CITY
localIDbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(LOCALID), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(localIDbynal6mos.modpoiss)
exp(coef(localIDbynal6mos.modpoiss))
summary(genderbynal6mos.modpoiss)
exp(coef(genderbynal6mos.modpoiss))
summary(agecatbynal6mos.modpoiss)
exp(coef(agecatbynal6mos.modpoiss))
summary(edbynal6mos.modpoiss)
exp(coef(edbynal6mos.modpoiss))
summary(homelessbynal6mos.modpoiss)
exp(coef(homelessbynal6mos.modpoiss))
summary(jailbynal6mos.modpoiss)
exp(coef(jailbynal6mos.modpoiss))
summary(anystiminjbynal6mos.modpoiss)
exp(coef(anystiminjbynal6mos.modpoiss))
summary(anyopiateinjbynal6mos.modpoiss)
exp(coef(anyopiateinjbynal6mos.modpoiss))
summary(WOD6Mbynal6mos.modpoiss)
exp(coef(WOD6Mbynal6mos.modpoiss))
summary(ODP6Mbynal6mos.modpoiss)
exp(coef(ODP6Mbynal6mos.modpoiss))
glm(NAL6MOS.new ~ factor(LOCALID), data=df, family=binomial(log))
exp(-0.371)
glm(NAL6MOS.new ~ factor(LOCALID), data=df, family=binomial(log))
exp(-0.371)
glm(NAL6MOS.new ~ factor(GENDER), data=df, family=binomial(log))
exp(0.0129)
exp( 0.0129 )
#glm(NAL6MOS.new ~ factor(LOCALID), data=df, family=binomial(log))
#glm(NAL6MOS.new ~ factor(GENDER), data=df, family=binomial(log))
glm(NAL6MOS.new ~ factor(agecat), data=df, family=binomial(log))
exp(-0.0471 )
table(df$NAL6MOS.new, useNA = "ifany")
#subset the data to those who have received naloxone in the last 6 mos
df_nal6mos <- subset(df, NAL6MOS.new == "Yes") #
#subset the data to those who have received naloxone in the last 6 mos
df_nal6mos <- subset(df, NAL6MOS.new == 1) #
table(df$NAL6MOS, useNA = "ifany")
table(df$NAL6MOS.new, useNA = "ifany")
# Create a table 1 stratified by currently owning naloxone
table1byNALOWN <- CreateTableOne(vars=myVars,
data=df_nal6mos,
factorVars = catVars,
strata="NALOWN")
print(table1byNALOWN, showAllLevels = TRUE, missing = FALSE)
table(df_nal6mos$NALOWN, useNA = "ifany")
188+76
#subset the data with complete observations because geepack is picky (N=
df.modpoiss.nalown <- subset(df_nal6mos, select=c(SUBJECT, NALOWN, LOCALID, GENDER, agecat, ED, HOMELESS, JAIL, ANYSTIMINJ, ANYOPIATEINJ, WOD6M, ODP6M))
df.modpoiss.nalown <- na.omit(df.modpoiss.nalown)
#LOCALID
localIDbynalown.modpoiss <- geeglm(formula=NALOWN ~ factor(LOCALID), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
table(df.modpoiss.nalown$NALOWN, useNA = "ifany")
class(df.modpoiss.nalown$NALOWN)
d
require(dplyr)
df.modpoiss.nalown$NALOWN <- df.modpoiss.nalown$NALOWN %>%
mutate(NALOWN = ifelse(NALOWN == "No",0,1))
df.modpoiss.nalown$NALOWN.binary <- as.numeric(as.factor(df.modpoiss.nalown$NALOWN))
table(df.modpoiss.nalown$NALOWN, useNA = "ifany")
table(df.modpoiss.nalown$NALOWN.binary, useNA = "ifany")
library(plyr)
library(plyr)
df.modpoiss.nalown$NALOWN.binary <- revalue(df.modpoiss.nalown$NALOWN, c("Yes"=1))
df.modpoiss.nalown$NALOWN.binary <- revalue(df.modpoiss.nalown$NALOWN, c("No"=0))
table(df.modpoiss.nalown$NALOWN, useNA = "ifany")
table(df.modpoiss.nalown$NALOWN.binary, useNA = "ifany")
df.modpoiss.nalown$NALOWN.binary <- revalue(df.modpoiss.nalown$NALOWN, c("Yes"=1))
table(df.modpoiss.nalown$NALOWN.binary, useNA = "ifany")
table(df.modpoiss.nalown$NALOWN.binary, useNA = "ifany")
df.modpoiss.nalown$NALOWN.binary <- revalue(df.modpoiss.nalown$NALOWN, c("No"=0))
table(df.modpoiss.nalown$NALOWN.binary, useNA = "ifany")
df.modpoiss.nalown$NALOWN.binary<-ifelse(df.modpoiss.nalown$NALOWN=='Yes', 1,0)
table(df.modpoiss.nalown$NALOWN, useNA = "ifany")
table(df.modpoiss.nalown$NALOWN.binary, useNA = "ifany")
#LOCALID
localIDbynalown.modpoiss <- geeglm(formula=NALOWN ~ factor(LOCALID), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
#LOCALID
localIDbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(LOCALID), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(localIDbynalown.modpoiss)
exp(coef(localIDbynalown.modpoiss))
#GENDER
genderbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(GENDER), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(genderbynalown.modpoiss)
exp(coef(genderbynalown.modpoiss))
#agecat
agecatbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(agecat), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(agecatbynalown.modpoiss)
exp(coef(agecatbynalown.modpoiss))
#ED
edbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ED), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(edbynalown.modpoiss)
exp(coef(edbynalown.modpoiss))
#HOMELESS
homelessbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(HOMELESS), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(homelessbynalown.modpoiss)
exp(coef(homelessbynalown.modpoiss))
#JAIL
jailbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(JAIL), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(jailbynalown.modpoiss)
exp(coef(jailbynalown.modpoiss))
#ANYSTIMINJ
anystiminjbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYSTIMINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anystiminjbynalown.modpoiss)
exp(coef(anystiminjbynalown.modpoiss))
#ANYOPIATEINJ
anyopiatebynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYOPIATEINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anyopiatebynalown.modpoiss)
exp(coef(anyopiatebynalown.modpoiss))
#ANYOPIATEINJ
anyopiateinjbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYOPIATEINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anyopiateinjbynalown.modpoiss)
exp(coef(anyopiateinjbynalown.modpoiss))
#WOD6M
WOD6Mbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(WOD6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(WOD6Mbynalown.modpoiss)
exp(coef(WOD6Mbynalown.modpoiss))
#ODP6M
ODP6Mbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ODP6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(ODP6Mbynalown.modpoiss)
exp(coef(ODP6Mbynalown.modpoiss))
#multivariate model
fitnalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(LOCALID) + factor(GENDER) + factor(agecat) + factor(ED) + factor(HOMELESS) + factor(JAIL) + factor(ANYSTIMINJ) + factor(ANYOPIATEINJ) + factor(WOD6M) + factor(ODP6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(fitnalown.modpoiss)
#extract the coefficients and confidence intervals, exponentiate to get RR and 95% CI (using confint.default)
fitnalown.RR.coefci.adj <- cbind(fitnalown.modpoiss$coefficients, confint.default(fitnalown.modpoiss))
fitnalown.RR.expci.adj <- exp(fitnalown.RR.coefci.adj)
fitnalown.RR.expci.adj
