add_pi(test, names = c("lpb", "upb"), alpha = 0.1, nSims = 20000)
df_ints <- add_ci(df, test, names = c("lcb", "ucb"), alpha = 0.05) %>%
add_pi(test, names = c("lpb", "upb"), alpha = 0.1, nSims = 20000)
df_ints <- add_ci(df, test, names = c("lcb", "ucb"), alpha = 0.05) %>%
add_pi(test, names = c("lpb", "upb"), alpha = 0.1, nSims = 20000)
model.nb.offset.reduced <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + offset(log(df$SUMINJ)), data = df, na.action = na.omit)
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(lme4)
library(MASS)
library(mice)
library(biostat3)
library(lmtest)
library(gee)
library(ciTools)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
#df.labels$description[df.labels$VAR_ID=="SUMINJ"]
#df.labels$description[df.labels$VAR_ID=="IJWOTH"]
#total number of injections last 30 days
df$SUMINJ <- as.numeric(as.character(df$SUMINJ))
table(df$SUMINJ, useNA = "ifany")
#frequency of injecting with others in last 6 months
table(df$IJWOTH, useNA = "ifany")
#convert to 3 level variable (0 = never, 1 = occasionally/sometimes, 2 = usually/always)
df$IJWOTH_3cat <- as.factor(ifelse(df$IJWOTH=="Never (0% of the time)", 0, ifelse(df$IJWOTH=="Occasionally (less than 25% of the time)" | df$IJWOTH=="Sometimes (25% to 74% of the time)", 1, ifelse(df$IJWOTH=="Usually (75% to 99% of the time)" | df$IJWOTH=="Always (100% of the time)", 2, NA))))
class(df$IJWOTH_3cat)
df$IJWOTH_3cat <- as.numeric(as.character(df$IJWOTH_3cat))
table(df$IJWOTH_3cat, useNA = "ifany")
#Subsetting the analytic sample to people with greater than 0 injections and greater than never injecting with others.
df <- subset(df, SUMINJ>0) #sample from 984 to 979
df <- subset(df, IJWOTH_3cat>0) #sample from 979 to 879
#public injection
table(df$PUBINJ, useNA = "ifany") #Frequency of public injection (ordinal)
#convert to 3 level variable (0 = never, 1 = occasionally/sometimes, 2 = usually/always)
df$PUBINJ_3cat <- as.factor(ifelse(df$PUBINJ=="Never (0% of the time)", 0, ifelse(df$PUBINJ=="Occasionally (less than 25% of the time)" | df$PUBINJ=="Sometimes (25% to 74% of the time)", 1, ifelse(df$PUBINJ=="Usually (75% to 99% of the time)" | df$PUBINJ=="Always (100% of the time)", 2, NA))))
table(df$PUBINJ_3cat, useNA = "ifany")
class(df$PUBINJ_3cat)
table(df$RECSHR, useNA = "ifany") #Times used dirty needles last 6 months
df$RECSHR <- as.numeric(as.character(df$RECSHR))
#age at baseline (years)
df$AGE <- as.numeric(as.character(df$AGE))
table(df$AGE, useNA = "ifany")
#gender
table(df$GENDER, useNA = "ifany")
#homelessness
table(df$HOMELESS) #do you consider yourself homeless
df$MOSHOME <- as.numeric(as.character(df$MOSHOME)) #number of months homeless
df$YRSHOME <- df$MOSHOME/12
table(df$HOMELESS, useNA = "ifany")
table(df$MOSHOME, useNA = "ifany")
table(df$YRSHOME, useNA = "ifany")
#crack injection
table(df$CRKINJ, useNA = "ifany")
#powder cocaine injection
table(df$CCINJ, useNA = "ifany")
#meth injection
table(df$MTINJ, useNA = "ifany")
#prescription stimulant injection
table(df$STINJ, useNA = "ifany")
#heroin injection
table(df$HRINJ, useNA = "ifany")
#NMPO injection
table(df$OPINJ, useNA = "ifany")
#alcohol
df$ALCDAY <- as.numeric(as.character(df$ALCDAY)) #Days of alcohol use in last 30 days
df$ALCTX <- as.numeric(as.character(df$ALCTX)) #Times you drank on a typical day
df$binge <- ifelse(df$ALCDAY==0, 0, ifelse(df$ALCTX<4, 0, ifelse(df$ALCTX>3, 1, NA))) #binge alcohol on a typical day (>3 drinks)
table(df$ALCDAY, useNA = "ifany")
table(df$ALCTX, useNA = "ifany")
table(df$binge, useNA = "ifany")
#any stimulant injection (composite)
df$ANYSTIM <- ifelse(df$CRKINJ=="Yes" | df$CCINJ=="Yes" | df$MTINJ=="Yes" | df$STINJ=="Yes", 1, ifelse(df$CRKINJ=="No" & df$CCINJ=="No" & df$MTINJ=="No" & df$STINJ=="No", 0, NA))
table(df$ANYSTIM, useNA = "ifany")
#any opioid injection (composite)
df$ANYOPIATE <- ifelse(df$HRINJ=="Yes" | df$OPINJ=="Yes", 1, ifelse(df$HRINJ=="No" & df$OPINJ=="No", 0, NA))
table(df$ANYOPIATE, useNA = "ifany")
model.nb.offset.reduced <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + offset(log(df$SUMINJ)), data = df, na.action = na.omit)
summary(model.nb.offset.reduced)
df_ints <- add_ci(df, test, names = c("lcb", "ucb"), alpha = 0.05) %>%
add_pi(test, names = c("lpb", "upb"), alpha = 0.1, nSims = 20000)
df_ints <- add_ci(df, model.nb.offset.reduced, names = c("lcb", "ucb"), alpha = 0.05) %>%
add_pi(model.nb.offset.reduced, names = c("lpb", "upb"), alpha = 0.1, nSims = 20000)
#comparing negative binomials with offset, with and without the anystim and anyopiate variables
lrtest(model.nb.offset, model.nb.offset.reduced)
model.nb.offset <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + ANYSTIM + ANYOPIATE + offset(log(df$SUMINJ)), data = df, na.action = na.omit)
summary(model.nb.offset)
#comparing negative binomials with offset, with and without the anystim and anyopiate variables
lrtest(model.nb.offset, model.nb.offset.reduced)
AIC(model.nb.offset, model.nb.offset.reduced)
? glm.nb
confint(model.nb.offset.reduced, parm, level = 0.95, trace = FALSE)
summary(model.nb.offset.reduced)
confint(model.nb.offset.reduced, "PUBINJ_3cat1", level = 0.95, trace = FALSE)
confint(model.nb.offset.reduced, "PUBINJ_3cat2", level = 0.95, trace = FALSE)
exp(5.804368)
confint(model.nb.offset.reduced, c("PUBINJ_3cat1","PUBINJ_3cat2"), level = 0.95, trace = FALSE)
(est <- cbind(Estimate = coef(model.nb.offset.reduced), confint(model.nb.offset.reduced)))
model.nb.offset.reduced <- glm.nb(RECSHR ~ PUBINJ_3cat*HOMELESS + GENDER + AGE + offset(log(df$SUMINJ)), data = df, na.action = na.omit)
exp(est)
#confidence intervals for  coefficients
(est <- cbind(Estimate = coef(model.nb.offset), confint(model.nb.offset)))
#confidence intervals for  coefficients
(est <- cbind(Estimate = coef(model.nb.offset), confint(model.nb.offset)))
exp(est)
summary(model.nb.offset)
exp(est)
#confidence intervals for  coefficients
(est <- cbind(Estimate = coef(model.nb.offset.reduced), confint(model.nb.offset.reduced)))
exp(est)
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
table(df$FU2)
448+536
df <- subset(df, FU2=1) #sample from 984 to 979
df <- subset(df, FU2==1) #sample from 984 to 979
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
table(df$FU2, useNA = "ifany")
df <- subset(df, FU2==1) #sample from 984 536 who were present at FU2
#ODP6M: Overdosed in the last 6 months
table(df$ODP6M2, useNA = "ifany")
table(df$NALEVER2, useNA = "ifany")
table(df$NAL6MOS2, useNA = "ifany")
#NAL6ORG: Naloxone from whom in the last 6 months (ISSUE WITH THIS VARIABLE: FACTOR(0))
table(df$NAL6ORG2, useNA = "ifany")
table(df$NALOWN2, useNA = "ifany")
table(df$NALAVAIL2, useNA = "ifany")
table(df$USEDNAL2, useNA = "ifany")
#ODP6M: Overdosed in the last 6 months
table(df$ODP6M2, useNA = "ifany")
table(df$ODTIMES2, useNA = "ifany")
table(df$FENTOD2, useNA = "ifany")
#FENTOD: Number of fentanyl related overdoses
table(df$FENTOD2, useNA = "ifany")
table(df$ODDRUG2, useNA = "ifany")
table(df$WOD6M2, useNA = "ifany")
#WODX6M: Number of witnessed overdoses in the last 6 months
table(df$WODX6M2, useNA = "ifany")
#NARCAN2: More than one dose of narcan to revive person
table(df$NARCAN2, useNA = "ifany")
#RIGID: Rigidty or seizures during the overdose
table(df$RIGID2, useNA = "ifany")
#IMMED: Any immediate overdoses
table(df$IMMED2, useNA = "ifany")
table(df$USEDNAL2, useNA = "ifany")
#OD911: Number of witnessed od where 911 was called in the last 30 days"
table(df$OD9112, useNA = "ifany")
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
table(df$FU2, useNA = "ifany")
df <- subset(df, FU2==1) #sample from 984 536 who were present at FU2
#ODP6M: Overdosed in the last 6 months
table(df$ODP6M2, useNA = "ifany")
#ODTIMES: Times overdosed in the last 6 months
table(df$ODTIMES2, useNA = "ifany")
#FENTOD: Number of fentanyl related overdoses
table(df$FENTOD2, useNA = "ifany")
#ODDRUG: Drugs used when overdosed the last time
table(df$ODDRUG2, useNA = "ifany")
#WOD6M: Witnessed an overdose in the last 6 months
#In the last 6 months, have you witnessed a heroin or opiate overdose?
table(df$WOD6M2, useNA = "ifany")
#NARCAN2: More than one dose of narcan to revive person
table(df$NARCAN2, useNA = "ifany")
#RIGID: Rigidty or seizures during the overdose
#During the overdose(s) that you witnessed, did any one of the victims have immediate body rigidity or seizures?
table(df$RIGID2, useNA = "ifany")
#IMMED: Any immediate overdoses
#Of the overdoses you witnessed, did any of the victims overdose immediately or shortly after taking their shot?
table(df$IMMED2, useNA = "ifany")
#USEDNAL: Times naloxone used by bystander to prevent overdose in the last 30 days
#In the last 6 months, how many of these witnessed overdoses did you or someone else who was not an EMT or police officer use naloxone or narcan?
table(df$USEDNAL2, useNA = "ifany")
#OD911: Number of witnessed od where 911 was called in the last 30 days
#In the last 6 months, how many of these witnessed overdoses did you or someone else call 911?
table(df$OD9112, useNA = "ifany")
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector of naloxone) to use on yourself or other people?
#NALEVER: Ever received naloxone (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALEVER2, useNA = "ifany")
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector of naloxone) to use on yourself or other people?
#NALEVER: Ever received naloxone (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALEVER, useNA = "ifany")
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector of naloxone) to use on yourself or other people?
#NALEVER: Ever received naloxone (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALEVER2, useNA = "ifany")
#Have you received naloxone in the last 6 months?
#NAL6MOS: Received naloxone in the last 6 months (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NAL6MOS2, useNA = "ifany")
#Have you received naloxone in the last 6 months?
#NAL6MOS: Received naloxone in the last 6 months (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NAL6MOS, useNA = "ifany")
#From whom did you receive naloxone, narcan, intranasal narcan, and/or autoinjector/evzio in the last 6 months?
#NAL6ORG: Naloxone from whom in the last 6 months  (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NAL6ORG2, useNA = "ifany")
#From whom did you receive naloxone, narcan, intranasal narcan, and/or autoinjector/evzio in the last 6 months?
#NAL6ORG: Naloxone from whom in the last 6 months  (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NAL6ORG, useNA = "ifany")
#Do you currently have at least one dose of naloxone? (By this, we mean you possess or own your own naloxone dose)
#NALOWN: Own a dose of naloxone (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALOWN2, useNA = "ifany")
#Do you currently have at least one dose of naloxone? (By this, we mean you possess or own your own naloxone dose)
#NALOWN: Own a dose of naloxone (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALOWN, useNA = "ifany")
df.labels$description[df.labels$VAR_ID=="NALAVAIL2"]
df.labels$description[df.labels$VAR_ID=="NALAVAIL"]
E
#USEDNAL: Times naloxone used by bystander to prevent overdose in the last 30 days
#In the last 6 months, how many of these witnessed overdoses did you or someone else who was not an EMT or police officer use naloxone or narcan?
table(df$USEDNAL2, useNA = "ifany")
#NALAVAIL: Naloxone available (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALAVAIL2, useNA = "ifany")
#NALAVAIL: Naloxone available (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALAVAIL, useNA = "ifany")
df.labels$description[df.labels$VAR_ID=="NALAVAIL"]
View(df.labels)
#ODTRAIN: Have you ever participated in overdose prevention training?
table(df$ODTRAIN, useNA = "ifany")
#ODTRAIN: Have you ever participated in overdose prevention training?
table(df$ODTRAIN2, useNA = "ifany")
#ODTRAIN: Have you ever participated in overdose prevention training?
table(df$ODTRAIN2, useNA = "ifany")
#ODTRAIN: Have you ever participated in overdose prevention training?
table(df$ODTRAIN, useNA = "ifany")
#ODTRAIN: Have you ever participated in overdose prevention training?
table(df$ODTRAIN1, useNA = "ifany")
#ODTRAIN: Have you ever participated in overdose prevention training?
table(df$ODTRAIN1, useNA = "ifany")
#ODTBY: From whom did you receive overdose prevention training?
table(df$ODTBY, useNA = "ifany")
#ODTBY: From whom did you receive overdose prevention training?
table(df$ODTBY1, useNA = "ifany")
#ODTBY: From whom did you receive overdose prevention training?
table(df$ODTBY12, useNA = "ifany")
#ODTBY: From whom did you receive overdose prevention training?
table(df$ODTBY2, useNA = "ifany")
#ODTBY: From whom did you receive overdose prevention training?
table(df$ODTBY, useNA = "ifany")
#ODTOTH: What is the other organization or entity that provided you with overdose training?
table(df$ODTOTH, useNA = "ifany") #-> Is this just
#ODTOTH: What is the other organization or entity that provided you with overdose training?
table(df$ODTOTH1, useNA = "ifany") #-> Is this just
#ODTOTH: What is the other organization or entity that provided you with overdose training?
table(df$ODTOTH2, useNA = "ifany") #-> Is this just
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector of naloxone) to use on yourself or other people?
#NALEVER: Ever received naloxone (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALEVER2, useNA = "ifany") #-> is this just NALEVER?
table(df$NAL6ORGOTH, useNA = "ifany") #-> Is this just NAL6ORG?
#Have you used your Naloxone in the last 6 months?
table(df$USEDNAL, useNA = "ifany") #-> Is this just NAL6ORG?
df.labels$description[df.labels$VAR_ID=="USEDNAL"]
df.labels$description[df.labels$VAR_ID=="USEDNAL1"]
df.labels$description[df.labels$VAR_ID=="USEDNAL2"]
table(df$USEDNAL, useNA = "ifany")
table(df$USEDNAL1, useNA = "ifany")
table(df$USEDNAL2, useNA = "ifany")
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
table(df$FU2, useNA = "ifany")
df <- subset(df, FU2==1) #sample from 984 536 who were present at FU2
#ODP6M: Overdosed in the last 6 months
#In the last 6 months, have you overdosed?
table(df$ODP6M2, useNA = "ifany")
#ODTIMES: Times overdosed in the last 6 months
#How many times did you overdose in the last 6 months?
table(df$ODTIMES2, useNA = "ifany")
#FENTOD: Number of fentanyl related overdoses
#In the last 6 months, when you overdosed, how many times had you been using Fentanyl or drugs with Fentanyl in it?
table(df$FENTOD2, useNA = "ifany")
#ODDRUG: Drugs used when overdosed the last time
#The last time you overdosed, what drug or drugs had you been using?  Check all that apply
table(df$ODDRUG2, useNA = "ifany")
#WOD6M: Witnessed an overdose in the last 6 months
#In the last 6 months, have you witnessed a heroin or opiate overdose?
table(df$WOD6M2, useNA = "ifany")
#WODX6M: Number of witnessed overdoses in the last 6 months
#In the last 6 months, how many heroin or opiate overdoses have you witnessed?
table(df$WODX6M2, useNA = "ifany")
#NARCAN2: More than one dose of narcan to revive person
#Of the overdoses you witnessed where naloxone was used, did any of them require more than one dose to revive the person to the best of your knowledge?
table(df$NARCAN2, useNA = "ifany")
#RIGID: Rigidty or seizures during the overdose
#During the overdose(s) that you witnessed, did any one of the victims have immediate body rigidity or seizures?
table(df$RIGID2, useNA = "ifany")
#IMMED: Any immediate overdoses
#Of the overdoses you witnessed, did any of the victims overdose immediately or shortly after taking their shot?
table(df$IMMED2, useNA = "ifany")
#OD911: Number of witnessed od where 911 was called in the last 30 days
#In the last 6 months, how many of these witnessed overdoses did you or someone else call 911?
table(df$OD9112, useNA = "ifany")
#ODTRAIN: Have you ever participated in overdose prevention training?
table(df$ODTRAIN2, useNA = "ifany") #-> Is this just ODTRAIN or ODTRAIN1?
table(df$NALEVER2, useNA = "ifany")
table(df$NALEVER, useNA = "ifany")
table(df$NALEVER1, useNA = "ifany")
table(df$NAL6MOS2, useNA = "ifany")
table(df$NAL6MOS, useNA = "ifany")
table(df$NAL6MOS1, useNA = "ifany")
table(df$NAL6ORG2, useNA = "ifany")
table(df$NAL6ORG, useNA = "ifany")
table(df$NAL6ORG1, useNA = "ifany")
table(df$NALOWN2, useNA = "ifany")
#table(df$NALOWN, useNA = "ifany")
table(df$NALOWN, useNA = "ifany")
table(df$NALOWN1, useNA = "ifany")
#NALAVAIL: Naloxone available (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALAVAIL2, useNA = "ifany")
#NALAVAIL: Naloxone available (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALAVAIL, useNA = "ifany")
#NALAVAIL: Naloxone available (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALAVAIL, useNA = "ifany")
#NALAVAIL: Naloxone available (ISSUE WITH THIS VARIABLE: < table of extent 0 >)
table(df$NALAVAIL1, useNA = "ifany")
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
#df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#load the data
#df <- read.spss("Ricky.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
View(df.labels)
names(df)
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
View(df)
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
df[rowSums(is.na(df)) != ncol(df), ]
df[apply(df,1,function(x)any(!is.na(x))),]
final <- na.omit(df)
df[rowSums(is.na(df)) != ncol(df),]
names(df)
df<-df[-which(apply(df,1,function(x)all(is.na(x)))),]
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df <- df[rowSums(is.na(df)) != ncol(df),]
df <- df[rowSums(is.na(df)) != ncol(df),]
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df <- df[!apply(is.na(df) | df == "", 1, all),]
View(df)
library(dplyr)
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df %>% filter_all(any_vars(!is.na(.)))
df %>% filter_all(any_vars(complete.cases(.)))
install.packages("janitor")
install.packages("janitor")
install.packages("janitor")
install.packages("janitor")
install.packages("janitor")
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
library(janitor)
knitr::opts_chunk$set(echo = F, eval=F, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
library(janitor)
library(dplyr)
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
df<-df[-which(apply(df,1,function(x)all(is.na(x)))),] #deletes every single row in my dataset so I have 0 obs
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df[rowSums(is.na(df)) != ncol(df),] #doesn't actually seem to do anything
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df %>% remove_empty("rows")
df %>% janitor::remove_empty("rows") #doesn't actually seem to do anything. N = 984 stays the same.
ncol(df)
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
df[rowSums(is.na(df)) != 696,]
which(rowSums(is.na(df))==ncol(df))
