#agecat
agecatbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(agecat), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(agecatbynalown.modpoiss)
exp(coef(agecatbynalown.modpoiss))
#ED
edbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ED), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(edbynalown.modpoiss)
exp(coef(edbynalown.modpoiss))
#HOMELESS
homelessbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(HOMELESS), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(homelessbynalown.modpoiss)
exp(coef(homelessbynalown.modpoiss))
#JAIL
jailbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(JAIL), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(jailbynalown.modpoiss)
exp(coef(jailbynalown.modpoiss))
#ANYSTIMINJ
anystiminjbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYSTIMINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anystiminjbynalown.modpoiss)
exp(coef(anystiminjbynalown.modpoiss))
#ANYOPIATEINJ
anyopiatebynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYOPIATEINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anyopiatebynalown.modpoiss)
exp(coef(anyopiatebynalown.modpoiss))
#ANYOPIATEINJ
anyopiateinjbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYOPIATEINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anyopiateinjbynalown.modpoiss)
exp(coef(anyopiateinjbynalown.modpoiss))
#WOD6M
WOD6Mbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(WOD6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(WOD6Mbynalown.modpoiss)
exp(coef(WOD6Mbynalown.modpoiss))
#ODP6M
ODP6Mbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ODP6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(ODP6Mbynalown.modpoiss)
exp(coef(ODP6Mbynalown.modpoiss))
#multivariate model
fitnalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(LOCALID) + factor(GENDER) + factor(agecat) + factor(ED) + factor(HOMELESS) + factor(JAIL) + factor(ANYSTIMINJ) + factor(ANYOPIATEINJ) + factor(WOD6M) + factor(ODP6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(fitnalown.modpoiss)
#extract the coefficients and confidence intervals, exponentiate to get RR and 95% CI (using confint.default)
fitnalown.RR.coefci.adj <- cbind(fitnalown.modpoiss$coefficients, confint.default(fitnalown.modpoiss))
fitnalown.RR.expci.adj <- exp(fitnalown.RR.coefci.adj)
fitnalown.RR.expci.adj
knitr::opts_chunk$set(echo = T, eval=T, warning = FALSE, message = FALSE, global.par=TRUE)
knitr::opts_knit$set(root.dir="~/Documents/GitHub/lizzyandshelley/Dataset")
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=85),tidy=TRUE)
library(base)
library(knitr)
library(dplyr)
library(here)
library(foreign)
library(labelled)
library(dplyr)
library(reshape2)
library(tableone)
library(forcats)
library(geepack)
library(doBy)
library(blm)
library(lmtest)
library(foreign)
library(MASS)
#set working directory
setwd("~/Documents/GitHub/lizzyandshelley/Dataset") #LIZZY
#load the data
df <- read.spss("CTC12month.SAV", use.value.labels = TRUE, to.data.frame=TRUE)
#get variable labels
attr(df, "variable.labels")
df.labels <- as.data.frame(attr(df, "variable.labels"))
QDSlabels <- data.frame(rownames(df.labels))
df.labels <- cbind(QDSlabels, df.labels)
names(df.labels) <- c("VAR_ID", "description")
rm(QDSlabels)
#USE THIS CODE TO LOOK UP A VARIABLE DESCRIPTION
#df.labels$description[df.labels$VAR_ID=="GENDER"]
df <- df[rowSums(is.na(df)) < 600,] #rows reduced from N=984 to N=536 people
#EXAMPLES OF SUBSETTING
#df <- subset(df, SUMINJ>0)
#df <- subset(df, IJWOTH_3cat>0)
#ODP6M: Overdosed in the last 6 months
#In the last 6 months, have you overdosed?
tbl.ODP6M <- table(df$ODP6M, useNA = "ifany")
tbl.ODP6M
prop.table(tbl.ODP6M)
#ODTIMES: Times overdosed in the last 6 months
#How many times did you overdose in the last 6 months?
tbl.ODTIMES <- table(df$ODTIMES, useNA = "ifany")
tbl.ODTIMES
prop.table(tbl.ODTIMES)
#FENTOD: Number of fentanyl related overdoses
#In the last 6 months, when you overdosed, how many times had you been using Fentanyl
#or drugs with Fentanyl in it?
tbl.FENTOD <- table(df$FENTOD, useNA = "ifany")
tbl.FENTOD
prop.table(tbl.FENTOD)
#ODDRUG: Drugs used when overdosed the last time
#The last time you overdosed, what drug or drugs had you been using?  Check all that apply
table(df$ODDRUG, useNA = "ifany")
table(df$ODDRUGA, useNA = "ifany") #Crack cocaine
table(df$ODDRUGB, useNA = "ifany") #Powder cocaine
table(df$ODDRUGC, useNA = "ifany") #Methamphetamine
table(df$ODDRUGD, useNA = "ifany") #Heroin (by itself)
table(df$ODDRUGE, useNA = "ifany") #Speedball (heroin mixed with cocaine or crack)
table(df$ODDRUGF, useNA = "ifany") #Goofball (heroin mixed with speed)
table(df$ODDRUGG, useNA = "ifany") #Non-opiate pain relievers (percocet, percodan, darvon)
table(df$ODDRUGH, useNA = "ifany") #Opiates (vicodin, oxycontin, dilaudid)
table(df$ODDRUGI, useNA = "ifany") #Tranquilizers (klonopin, xanax, valium, atavan)
table(df$ODDRUGJ, useNA = "ifany") #Sedatives (restoril, tuinal, phenobarbatal)
table(df$ODDRUGK, useNA = "ifany") #Stimulants (ritalin, aderall, methadrine, bezedrine)
table(df$ODDRUGL, useNA = "ifany") #Methadone
table(df$ODDRUGM, useNA = "ifany") #Alcohol
table(df$ODDRUGN, useNA = "ifany") #Fentanyl or drugs w/fentanyl
#WOD6M: Witnessed an overdose in the last 6 months
#In the last 6 months, have you witnessed a heroin or opiate overdose?
tbl.WOD6M <- table(df$WOD6M, useNA = "ifany")
tbl.WOD6M
prop.table(tbl.WOD6M)
#WODX6M: Number of witnessed overdoses in the last 6 months
#In the last 6 months, how many heroin or opiate overdoses have you witnessed?
tbl.WODX6M <- table(df$WODX6M, useNA = "ifany")
tbl.WODX6M
prop.table(tbl.WODX6M)
#NARCAN: More than one dose of narcan to revive person
#Of the overdoses you witnessed where naloxone was used, did any of them require more than
#one dose to revive the person to the best of your knowledge?
tbl.NARCAN <- table(df$NARCAN, useNA = "ifany")
tbl.NARCAN
prop.table(tbl.NARCAN)
#RIGID: Rigidty or seizures during the overdose
#During the overdose(s) that you witnessed, did any one of the victims have immediate body
#rigidity or seizures?
tbl.RIGID <- table(df$RIGID, useNA = "ifany")
tbl.RIGID
prop.table(tbl.RIGID)
#IMMED: Any immediate overdoses
#Of the overdoses you witnessed, did any of the victims overdose immediately or shortly
#after taking their shot?
tbl.IMMED <- table(df$IMMED, useNA = "ifany")
tbl.IMMED
prop.table(tbl.IMMED)
#USEDNAL: Times naloxone used by bystander to prevent overdose in the last 30 days
#In the last 6 months, how many of these witnessed overdoses did you or someone else
#who was not an EMT or police officer use naloxone or narcan?
tbl.USEDNAL <- table(df$USEDNAL, useNA = "ifany")
tbl.USEDNAL
prop.table(tbl.USEDNAL)
#OD911: Number of witnessed od where 911 was called in the last 30 days
#In the last 6 months, how many of these witnessed overdoses did you or someone else call 911?
tbl.OD911 <- table(df$OD911, useNA = "ifany")
tbl.OD911
prop.table(tbl.OD911)
#ODTRAIN: Have you ever participated in overdose prevention training?
#Have you ever participated in overdose prevention training?
tbl.ODTRAIN <- table(df$ODTRAIN, useNA = "ifany")
tbl.ODTRAIN
prop.table(tbl.ODTRAIN)
#ODTBY: OD training from whom
#From whom did you receive overdose prevention training?
table(df$ODTBY, useNA = "ifany")
table(df$ODTBYA, useNA = "ifany") #Needle exchange
table(df$ODTBYB, useNA = "ifany") #Another drug user
table(df$ODTBYC, useNA = "ifany") #Another community member
table(df$ODTBYD, useNA = "ifany") #A family member
table(df$ODTBYE, useNA = "ifany") #Pharmacy
table(df$ODTBYF, useNA = "ifany") #Community clinic
table(df$ODTBYG, useNA = "ifany") #Hospital
table(df$ODTBYH, useNA = "ifany") #Jail or prison
table(df$ODTBYI, useNA = "ifany") #Other
#ODTOTH:Overdose training by other organization
#What is the other organization or entity that provided you with overdose training?
tbl.ODTOTH <- table(df$ODTOTH, useNA = "ifany")
tbl.ODTOTH
#NALEVER: Ever received naloxone
#Have you ever received naloxone (including narcan, intranasal narcan, and/or autoinjector
#of naloxone to use on yourself or other people?
tbl.NALEVER <- table(df$NALEVER, useNA = "ifany")
tbl.NALEVER
prop.table(tbl.NALEVER)
#NAL6MOS: Received naloxone in the last 6 months
#Have you received naloxone in the last 6 months?
tbl.NAL6MOS <- table(df$NAL6MOS, useNA = "ifany")
tbl.NAL6MOS
prop.table(tbl.NAL6MOS)
#NAL6MOSNEW: Creating new variable combining NALEVER AND NAL6MOS so that those who answered "No" to NALEVER are also "No" on NAL6MOS
#crosstab of NALEVER and NAL6MOS
table(df$NALEVER, df$NAL6MOS, useNA = "ifany")
df$NAL6MOS.new <- ifelse(df$NALEVER=="Yes" & df$NAL6MOS=="Yes", 1, ifelse(df$NALEVER=="Yes" & df$NAL6MOS=="No", 0, ifelse(df$NALEVER=="No", 0, NA)))
tbl.NAL6MOS.new <- table(df$NAL6MOS.new, useNA = "ifany")
tbl.NAL6MOS.new
prop.table(tbl.NAL6MOS.new)
#NAL6ORG: Naloxone from whom in the last 6 months
#From whom did you receive naloxone, narcan, intranasal narcan, and/or autoinjector/evzio in the last 6 months?
table(df$NAL6ORG, useNA = "ifany")
table(df$NAL6ORGA, useNA = "ifany") #Needle exchange
table(df$NAL6ORGB, useNA = "ifany") #Another drug user
table(df$NAL6ORGC, useNA = "ifany") #Another community member
table(df$NAL6ORGD, useNA = "ifany") #A family member
table(df$NAL6ORGE, useNA = "ifany") #Pharmacy
table(df$NAL6ORGF, useNA = "ifany") #Community clinic
table(df$NAL6ORGG, useNA = "ifany") #Hospital
table(df$NAL6ORGH, useNA = "ifany") #Jail or prison
table(df$NAL6ORGI, useNA = "ifany") #Other
#OTHNORG: Other organization that provided naloxone in the last 6 months
#What is the other organization or entity that provided you with naloxone in the last 6 months?
table(df$OTHNORG, useNA = "ifany")
#NALUSED:Used naloxone in the last 6 months
#Have you used your Naloxone in the last 6 months?
tbl.NALUSED <- table(df$NALUSED, useNA = "ifany")
tbl.NALUSED
prop.table(tbl.NALUSED)
#NALOSE: Lost naloxone in the last 6 months
#Have you lost your Naloxone in the last 6 months?
tbl.NALOSE <- table(df$NALOSE, useNA = "ifany")
tbl.NALOSE
prop.table(tbl.NALOSE)
#NALUSEandorLOSE: Have you used and/or used your naloxone in the last 6 months?
table(df$NALUSED, df$NALOSE, useNA = "ifany")
df$NALUSEandorLOSE <- ifelse((df$NALUSED=="Yes" | df$NALOSE=="Yes"), 1, 0)
tbl.NALUSEandorLOSE <- table(df$NALUSEandorLOSE, useNA = "ifany")
tbl.NALUSEandorLOSE
prop.table(tbl.NALUSEandorLOSE)
#NALFILL: Got a refill of naloxone in the last 6 months
#After using or losing your naloxone, did you get a replacement or refill?
tbl.NALFILL <- table(df$NALFILL, useNA = "ifany")
tbl.NALFILL
prop.table(tbl.NALFILL)
#TMEFILL: Days it took to refill or replace naloxone.
#How long after using or losing your Naloxone, did you get a replacement or refill?
tbl.TMEFILL <- table(df$TMEFILL, useNA = "ifany")
tbl.TMEFILL
prop.table(tbl.TMEFILL)
#NALPRVD: Who provided the naloxone replacement or refill
#From whom did you receive your naloxone replacement or refill?
table(df$NALPRVD, useNA = "ifany")
table(df$NALPRVDA, useNA = "ifany") #Needle exchange
table(df$NALPRVDB, useNA = "ifany") #Another drug user
table(df$NALPRVDC, useNA = "ifany") #Another community member
table(df$NALPRVDD, useNA = "ifany") #A family member
table(df$NALPRVDE, useNA = "ifany") #Pharmacy
table(df$NALPRVDF, useNA = "ifany") #Community clinic
table(df$NALPRVDG, useNA = "ifany") #Hospital
table(df$NALPRVDH, useNA = "ifany") #Jail or prison
table(df$NALPRVDI, useNA = "ifany") #Other
#OTHPRON: Replacement naloxone provided by what other organization
#What is the other organization or entity that provided you with naloxone dose replacement or refill?
table(df$OTHPRON, useNA = "ifany") #Other
#NALOWN: Own a dose of naloxone
#Do you currently have at least one dose of naloxone? (By this, we mean you possess
#or own your own naloxone dose)
tbl.NALOWN <- table(df$NALOWN, useNA = "ifany")
tbl.NALOWN
prop.table(tbl.NALOWN)
#NALAVAIL: Naloxone available
#In the last 6 months, when you injected drugs, how often did you or someone else around you have naloxone in the event of an overdose?
tbl.NALAVAIL <- table(df$NALAVAIL, useNA = "ifany")
tbl.NALAVAIL
prop.table(tbl.NALAVAIL)
#city
table(df$LOCALID, useNA = "ifany")
#gender (combine other and transgender into other so 3 cat variable)
df$GENDER <- df$GENDER %>% fct_collapse("Other" = c("Transgender","Other"))
table(df$GENDER, useNA = "ifany")
#age
table(df$AGE, useNA = "ifany")
table(df$agecat, useNA = "ifany") #(<30, 30 to 39, 40-49, 50 or more) MAY WANT TO RECUT THESE MYSELF
#education (High school education or more)
table(df$ED, useNA = "ifany")
#homelessness (Consider Self Homeless)
table(df$HOMELESS, useNA = "ifany")
#incarceration (Any jail in the last 6 months)
table(df$JAIL, useNA = "ifany")
#users of certain injection drugs
table(df$CRKINJ, useNA = "ifany") #crack injection
table(df$CCINJ, useNA = "ifany") #powder cocaine injection
table(df$MTINJ, useNA = "ifany") #meth injection
table(df$STINJ, useNA = "ifany") #prescription stimulant injection
table(df$HRINJ, useNA = "ifany") #heroin injection
table(df$OPINJ, useNA = "ifany") #NMPO injection
#any stimulant injection (composite)
df$ANYSTIMINJ <- ifelse(df$CRKINJ=="Yes" | df$CCINJ=="Yes" | df$MTINJ=="Yes" | df$STINJ=="Yes", 1, ifelse(df$CRKINJ=="No" & df$CCINJ=="No" & df$MTINJ=="No" & df$STINJ=="No", 0, NA))
df$ANYSTIMINJ <- as.factor(df$ANYSTIMINJ)
table(df$ANYSTIMINJ, useNA = "ifany")
#any opioid injection (composite)
df$ANYOPIATEINJ <- ifelse(df$HRINJ=="Yes" | df$OPINJ=="Yes", 1, ifelse(df$HRINJ=="No" & df$OPINJ=="No", 0, NA))
df$ANYOPIATEINJ <- as.factor(df$ANYOPIATEINJ)
table(df$ANYOPIATEINJ, useNA = "ifany")
#overdose witnessed (witnessed an overdose in the last 6 months)
table(df$WOD6M, useNA = "ifany")
#personal overdose history (Overdosed in the last 6 months)
table(df$ODP6M, useNA = "ifany")
View(df.labels)
#years since first injection
table(df$yrsinj, useNA = "ifany")
table(df$injyrcat, useNA = "ifany") #categorical
table(df$NDLSRCF, useNA = "ifany") #categorical
table(df$MTSYROU, useNA = "ifany") #categorical
table(df$NMNDLES, useNA = "ifany") #Number of new needles obtained for your
table(df$SIFEVR, useNA = "ifany") #Number of new needles obtained for your
table(df$NAL6MOS.new, useNA = "ifany")
270+265
# Identify the variables of interest
myVars <- c("LOCALID", "GENDER","agecat","ED","HOMELESS", "JAIL", "ANYSTIMINJ", "ANYOPIATEINJ", "WOD6M", "ODP6M")
# Specify which of the variables are categorical
catVars <- c("LOCALID", "GENDER", "agecat", "ED","HOMELESS", "JAIL", "ANYSTIMINJ", "ANYOPIATEINJ", "WOD6M", "ODP6M")
# Create an overall table 1
#REMINDER THAT TABLE1 PACKAGE DOES WEIRD STUFF WITH MISSING, SO CHECK N (PERCENTAGE) WITH CROSSTABS
table1.overall <- CreateTableOne(vars= myVars,
data= df,
factorVars = catVars)
print(table1.overall, showAllLevels = TRUE, missing = FALSE)
# Create a table 1 stratified by receiving naloxone in the last 6 mos (1 = ever received in last 6 mos, 0 = never received in last 6 mos)
##REMINDER THAT TABLE1 PACKAGE DOES WEIRD STUFF WITH MISSING, SO CHECK N (PERCENTAGE) WITH CROSSTABS
table1byNAL6MOS.new <- CreateTableOne(vars=myVars,
data=df,
factorVars = catVars,
strata="NAL6MOS.new")
print(table1byNAL6MOS.new, showAllLevels = TRUE, test=TRUE, missing = FALSE)
270+265
require(geepack)
#subset the data with complete observations because geepack is picky (N=527)
df.modpoiss <- subset(df, select=c(SUBJECT, NAL6MOS.new, LOCALID, GENDER, agecat, ED, HOMELESS, JAIL, ANYSTIMINJ, ANYOPIATEINJ, WOD6M, ODP6M))
df.modpoiss <- na.omit(df.modpoiss)
#CITY
localIDbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(LOCALID), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(localIDbynal6mos.modpoiss)
exp(coef(localIDbynal6mos.modpoiss))
localIDbynal6mos.modpoiss.RR.coefci.adj <- cbind(localIDbynal6mos.modpoiss$coefficients, confint.default(localIDbynal6mos.modpoiss))
localIDbynal6mos.modpoiss.RR.expci.adj <- exp(localIDbynal6mos.modpoiss.RR.coefci.adj)
localIDbynal6mos.modpoiss.RR.expci.adj
#GENDER
genderbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(GENDER), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(genderbynal6mos.modpoiss)
exp(coef(genderbynal6mos.modpoiss))
#95% CI for gender
genderbynal6mos.modpoiss.RR.coefci.adj <- cbind(genderbynal6mos.modpoiss$coefficients, confint.default(genderbynal6mos.modpoiss))
genderbynal6mos.modpoiss.RR.expci.adj <- exp(genderbynal6mos.modpoiss.RR.coefci.adj)
genderbynal6mos.modpoiss.RR.expci.adj
agecatbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(agecat), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(agecatbynal6mos.modpoiss)
exp(coef(agecatbynal6mos.modpoiss))
#95% CI for agecat
agecatbynal6mos.modpoiss.RR.coefci.adj <- cbind(agecatbynal6mos.modpoiss$coefficients, confint.default(agecatbynal6mos.modpoiss))
agecatbynal6mos.modpoiss.RR.expci.adj <- exp(agecatbynal6mos.modpoiss.RR.coefci.adj)
agecatbynal6mos.modpoiss.RR.expci.adj
edbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ED), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(edbynal6mos.modpoiss)
exp(coef(edbynal6mos.modpoiss))
#95% CI for ed
edbynal6mos.modpoiss.RR.coefci.adj <- cbind(edbynal6mos.modpoiss$coefficients, confint.default(edbynal6mos.modpoiss))
edbynal6mos.modpoiss.RR.expci.adj <- exp(edbynal6mos.modpoiss.RR.coefci.adj)
edbynal6mos.modpoiss.RR.expci.adj
homelessbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(HOMELESS), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(homelessbynal6mos.modpoiss)
exp(coef(homelessbynal6mos.modpoiss))
#95% CI for homeless
homelessbynal6mos.modpoiss.RR.coefci.adj <- cbind(homelessbynal6mos.modpoiss$coefficients, confint.default(homelessbynal6mos.modpoiss))
homelessbynal6mos.modpoiss.RR.expci.adj <- exp(homelessbynal6mos.modpoiss.RR.coefci.adj)
homelessbynal6mos.modpoiss.RR.expci.adj
#JAIL
jailbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(JAIL), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(jailbynal6mos.modpoiss)
exp(coef(jailbynal6mos.modpoiss))
#95% CI for jail
jailbynal6mos.modpoiss.RR.coefci.adj <- cbind(jailbynal6mos.modpoiss$coefficients, confint.default(jailbynal6mos.modpoiss))
jailbynal6mos.modpoiss.RR.expci.adj <- exp(jailbynal6mos.modpoiss.RR.coefci.adj)
jailbynal6mos.modpoiss.RR.expci.adj
#ANYSTIMINJ
anystiminjbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ANYSTIMINJ), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anystiminjbynal6mos.modpoiss)
exp(coef(anystiminjbynal6mos.modpoiss))
#95% CI for anystiminj
anystiminjbynal6mos.modpoiss.RR.coefci.adj <- cbind(anystiminjbynal6mos.modpoiss$coefficients, confint.default(anystiminjbynal6mos.modpoiss))
anystiminjbynal6mos.modpoiss.RR.expci.adj <- exp(anystiminjbynal6mos.modpoiss.RR.coefci.adj)
anystiminjbynal6mos.modpoiss.RR.expci.adj
#ANYOPIATEINJ
anyopiateinjbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ANYOPIATEINJ), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anyopiateinjbynal6mos.modpoiss)
exp(coef(anyopiateinjbynal6mos.modpoiss))
#95% CI for anyopiateinj
anyopiateinjbynal6mos.modpoiss.RR.coefci.adj <- cbind(anyopiateinjbynal6mos.modpoiss$coefficients, confint.default(anyopiateinjbynal6mos.modpoiss))
anyopiateinjbynal6mos.modpoiss.RR.expci.adj <- exp(anyopiateinjbynal6mos.modpoiss.RR.coefci.adj)
anyopiateinjbynal6mos.modpoiss.RR.expci.adj
#WOD6M
WOD6Mbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(WOD6M), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(WOD6Mbynal6mos.modpoiss)
exp(coef(WOD6Mbynal6mos.modpoiss))
#95% CI for WOD6M
WOD6Mbynal6mos.modpoiss.RR.coefci.adj <- cbind(WOD6Mbynal6mos.modpoiss$coefficients, confint.default(WOD6Mbynal6mos.modpoiss))
WOD6Mbynal6mos.modpoiss.RR.expci.adj <- exp(WOD6Mbynal6mos.modpoiss.RR.coefci.adj)
WOD6Mbynal6mos.modpoiss.RR.expci.adj
#ODP6M
ODP6Mbynal6mos.modpoiss <- geeglm(formula=NAL6MOS.new ~ factor(ODP6M), data=df.modpoiss, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(ODP6Mbynal6mos.modpoiss)
exp(coef(ODP6Mbynal6mos.modpoiss))
#95% CI for ODP6M
ODP6Mbynal6mos.modpoiss.RR.coefci.adj <- cbind(ODP6Mbynal6mos.modpoiss$coefficients, confint.default(ODP6Mbynal6mos.modpoiss))
ODP6Mbynal6mos.modpoiss.RR.expci.adj <- exp(ODP6Mbynal6mos.modpoiss.RR.coefci.adj)
ODP6Mbynal6mos.modpoiss.RR.expci.adj
table(df$NAL6MOS, useNA = "ifany")
table(df$NAL6MOS.new, useNA = "ifany")
122+149
#subset the data to those who have received naloxone in the last 6 mos
df_nal6mos <- subset(df, NAL6MOS.new == 1) #N = 265 who have received naloxone in the last 6 mos
#checking frequencies are correct
table(df_nal6mos$NALOWN, useNA = "ifany")
# Create a table 1 stratified by currently owning naloxone
table1byNALOWN <- CreateTableOne(vars=myVars,
data=df_nal6mos,
factorVars = catVars,
strata="NALOWN")
print(table1byNALOWN, showAllLevels = TRUE, missing = FALSE)
require(geepack)
#subset the data with complete observations because geepack is picky (N= 259)
df.modpoiss.nalown <- subset(df_nal6mos, select=c(SUBJECT, NALOWN, LOCALID, GENDER, agecat, ED, HOMELESS, JAIL, ANYSTIMINJ, ANYOPIATEINJ, WOD6M, ODP6M))
df.modpoiss.nalown <- na.omit(df.modpoiss.nalown)
table(df_nal6mos$NALOWN, useNA = "ifany")
#recode NALOWN as binary numeric since factor isn't working
df.modpoiss.nalown$NALOWN.binary<-ifelse(df.modpoiss.nalown$NALOWN=='Yes', 1,0)
table(df_nal6mos$NALOWN.binary, useNA = "ifany")
#recode NALOWN as binary numeric since factor isn't working
df.modpoiss.nalown$NALOWN.binary<-ifelse(df.modpoiss.nalown$NALOWN=='Yes', 1,0)
table(df_nal6mos$NALOWN.binary, useNA = "ifany")
geeglm(formula=NALOWN ~ factor(LOCALID), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
geeglm(formula=NALOWN.binary ~ factor(LOCALID), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
#subset the data with complete observations because geepack is picky (N= 259)
df.modpoiss.nalown <- subset(df_nal6mos, select=c(SUBJECT, NALOWN, LOCALID, GENDER, agecat, ED, HOMELESS, JAIL, ANYSTIMINJ, ANYOPIATEINJ, WOD6M, ODP6M))
df.modpoiss.nalown <- na.omit(df.modpoiss.nalown)
#recode NALOWN as binary numeric since factor isn't working
df.modpoiss.nalown$NALOWN.binary<-ifelse(df.modpoiss.nalown$NALOWN=='Yes', 1,0)
table(df_nal6mos$NALOWN.binary, useNA = "ifany")
table(df.modpoiss.nalown$NALOWN.binary, useNA = "ifany")
table(df_nal6mos$NALOWN, useNA = "ifany")
#LOCALID
localIDbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(LOCALID), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(localIDbynalown.modpoiss)
exp(coef(localIDbynalown.modpoiss))
#95% CI for localID
localIDbynalown.modpoiss.RR.coefci.adj <- cbind(localIDbynalown.modpoiss$coefficients, confint.default(localIDbynalown.modpoiss))
localIDbynalown.modpoiss.RR.expci.adj <- exp(localIDbynalown.modpoiss.RR.coefci.adj)
localIDbynalown.modpoiss.RR.expci.adj
#GENDER
genderbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(GENDER), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(genderbynalown.modpoiss)
exp(coef(genderbynalown.modpoiss))
#95% CI for gender
genderbynalown.modpoiss.RR.coefci.adj <- cbind(genderbynalown.modpoiss$coefficients, confint.default(genderbynalown.modpoiss))
genderbynalown.modpoiss.RR.expci.adj <- exp(genderbynalown.modpoiss.RR.coefci.adj)
genderbynalown.modpoiss.RR.expci.adj
#agecat
agecatbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(agecat), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(agecatbynalown.modpoiss)
exp(coef(agecatbynalown.modpoiss))
#95% CI for agecat
agecatbynalown.modpoiss.RR.coefci.adj <- cbind(agecatbynalown.modpoiss$coefficients, confint.default(agecatbynalown.modpoiss))
agecatbynalown.modpoiss.RR.expci.adj <- exp(agecatbynalown.modpoiss.RR.coefci.adj)
agecatbynalown.modpoiss.RR.expci.adj
#ED
edbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ED), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(edbynalown.modpoiss)
exp(coef(edbynalown.modpoiss))
#95% CI for ed
edbynalown.modpoiss.RR.coefci.adj <- cbind(edbynalown.modpoiss$coefficients, confint.default(edbynalown.modpoiss))
edbynalown.modpoiss.RR.expci.adj <- exp(edbynalown.modpoiss.RR.coefci.adj)
edbynalown.modpoiss.RR.expci.adj
#HOMELESS
homelessbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(HOMELESS), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(homelessbynalown.modpoiss)
exp(coef(homelessbynalown.modpoiss))
#95% CI for homeless
homelessbynalown.modpoiss.RR.coefci.adj <- cbind(homelessbynalown.modpoiss$coefficients, confint.default(homelessbynalown.modpoiss))
homelessbynalown.modpoiss.RR.expci.adj <- exp(homelessbynalown.modpoiss.RR.coefci.adj)
homelessbynalown.modpoiss.RR.expci.adj
#JAIL
jailbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(JAIL), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(jailbynalown.modpoiss)
exp(coef(jailbynalown.modpoiss))
#95% CI for jail
jailbynalown.modpoiss.RR.coefci.adj <- cbind(jailbynalown.modpoiss$coefficients, confint.default(jailbynalown.modpoiss))
jailbynalown.modpoiss.RR.expci.adj <- exp(jailbynalown.modpoiss.RR.coefci.adj)
jailbynalown.modpoiss.RR.expci.adj
#ANYSTIMINJ
anystiminjbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYSTIMINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anystiminjbynalown.modpoiss)
exp(coef(anystiminjbynalown.modpoiss))
#95% CI for anystiminj
anystiminjbynalown.modpoiss.RR.coefci.adj <- cbind(anystiminjbynalown.modpoiss$coefficients, confint.default(anystiminjbynalown.modpoiss))
anystiminjbynalown.modpoiss.RR.expci.adj <- exp(anystiminjbynalown.modpoiss.RR.coefci.adj)
anystiminjbynalown.modpoiss.RR.expci.adj
#ANYOPIATEINJ
anyopiateinjbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ANYOPIATEINJ), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(anyopiateinjbynalown.modpoiss)
exp(coef(anyopiateinjbynalown.modpoiss))
#95% CI for anyopiateinj
anyopiateinjbynalown.modpoiss.RR.coefci.adj <- cbind(anyopiateinjbynalown.modpoiss$coefficients, confint.default(anyopiateinjbynalown.modpoiss))
anyopiateinjbynalown.modpoiss.RR.expci.adj <- exp(anyopiateinjbynalown.modpoiss.RR.coefci.adj)
anyopiateinjbynalown.modpoiss.RR.expci.adj
#WOD6M
WOD6Mbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(WOD6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(WOD6Mbynalown.modpoiss)
exp(coef(WOD6Mbynalown.modpoiss))
#95% CI for WOD6M
WOD6Mbynalown.modpoiss.RR.coefci.adj <- cbind(WOD6Mbynalown.modpoiss$coefficients, confint.default(WOD6Mbynalown.modpoiss))
WOD6Mbynalown.modpoiss.RR.expci.adj <- exp(WOD6Mbynalown.modpoiss.RR.coefci.adj)
WOD6Mbynalown.modpoiss.RR.expci.adj
#ODP6M
ODP6Mbynalown.modpoiss <- geeglm(formula=NALOWN.binary ~ factor(ODP6M), data=df.modpoiss.nalown, id=SUBJECT, family=poisson(link="log"), corstr = "exchangeable")
summary(ODP6Mbynalown.modpoiss)
exp(coef(ODP6Mbynalown.modpoiss))
#95% CI for ODP6M
ODP6Mbynalown.modpoiss.RR.coefci.adj <- cbind(ODP6Mbynalown.modpoiss$coefficients, confint.default(ODP6Mbynalown.modpoiss))
ODP6Mbynalown.modpoiss.RR.expci.adj <- exp(ODP6Mbynalown.modpoiss.RR.coefci.adj)
ODP6Mbynalown.modpoiss.RR.expci.adj
